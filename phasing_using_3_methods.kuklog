     1896 Loading data
     7767 ----------------------------------------
     7767 Training model_31 on 320 sequences
     7767 sequences.shape: torch.Size([320, 6000, 2])
     7768 Total sites to phase: 922
     7768 Learning rate: 0.04
     7768 Seed: 0
     7769 Step	Loss	 Time 	  Total time
    28450     0	2.77252	 20.681 s 	 20.681 s
    45240     1	2.64879	 16.79 s 	 37.471 s
    62016     2	2.52701	 16.776 s 	 54.247 s
    78316     3	2.41373	 16.3 s 	 70.547 s
    95385     4	2.30075	 17.068 s 	 87.616 s
   112697     5	2.19312	 17.312 s 	 104.928 s
   129575     6	2.09537	 16.877 s 	 121.806 s
   146717     7	1.99867	 17.142 s 	 138.948 s
   163263     8	1.90252	 16.546 s 	 155.494 s
   179991     9	1.81663	 16.728 s 	 172.222 s
   196664    10	1.75207	 16.672 s 	 188.895 s
   213303    11	1.66168	 16.639 s 	 205.534 s
   229886    12	1.57641	 16.583 s 	 222.117 s
   246424    13	1.5199	 16.538 s 	 238.655 s
   263135    14	1.4579	 16.711 s 	 255.366 s
   280025    15	1.403	 16.89 s 	 272.256 s
   296554    16	1.34687	 16.528 s 	 288.785 s
   313196    17	1.29981	 16.641 s 	 305.427 s
   330472    18	1.24656	 17.276 s 	 322.703 s
   347074    19	1.19758	 16.602 s 	 339.305 s
   364093    20	1.16915	 17.019 s 	 356.324 s
   380920    21	1.12393	 16.826 s 	 373.151 s
   397810    22	1.09067	 16.89 s 	 390.041 s
   414665    23	1.04725	 16.855 s 	 406.896 s
   431433    24	0.99267	 16.768 s 	 423.664 s
   448225    25	1.02091	 16.791 s 	 440.456 s
   465024    26	0.95835	 16.798 s 	 457.255 s
   481732    27	0.95831	 16.708 s 	 473.963 s
   498450    28	0.89518	 16.717 s 	 490.681 s
   515352    29	0.88698	 16.902 s 	 507.583 s
   531988    30	0.85805	 16.636 s 	 524.219 s
   548683    31	0.8598	 16.694 s 	 540.914 s
   565631    32	0.81712	 16.948 s 	 557.862 s
   582251    33	0.83545	 16.619 s 	 574.482 s
   598853    34	0.84436	 16.602 s 	 591.084 s
   615616    35	0.78517	 16.762 s 	 607.847 s
   632356    36	0.78919	 16.74 s 	 624.587 s
   648952    37	0.75812	 16.596 s 	 641.183 s
   665710    38	0.79271	 16.758 s 	 657.941 s
   682329    39	0.78511	 16.619 s 	 674.56 s
   699960    40	0.77535	 17.63 s 	 692.191 s
   716586    41	0.73307	 16.626 s 	 708.817 s
   733121    42	0.73357	 16.535 s 	 725.352 s
   749924    43	0.73499	 16.803 s 	 742.155 s
   766529    44	0.70825	 16.605 s 	 758.761 s
   783028    45	0.76439	 16.499 s 	 775.259 s
   799876    46	0.72193	 16.847 s 	 792.107 s
   816457    47	0.70285	 16.581 s 	 808.688 s
   833112    48	0.68162	 16.655 s 	 825.343 s
   849893    49	0.70021	 16.781 s 	 842.124 s
   898369 training loss = 0.5323362630208334
   898370 ----------------------------------------
   898370 Evaluating on 40 valid sequences
   944683 valid loss = 0.5100805338541666
   944684 model_31 capacity = 24 parameters
   944684 ----------------------------------------
   944684 Phasing 40 test sequences
   944684 ====================Phasing test: predictive (#1)====================
   944684 sampling using predictive method
   967990 w_list shape: torch.Size([40, 6000])
   967990 x_list shape: torch.Size([40, 6000])
   967990 y_list shape: torch.Size([40, 6000])
   967992 batches: [tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39], dtype=torch.int32)]
   968031 ----------------------------------------
   968031 Sanity check I, comparing statistics from valid sequences and generated sequences:
   968032 proportion of alts in generated w_list and x_list:  0.0877125	0.0896375
   968034 proportion of alts in corresponding full sequences: 0.07647916666666667	0.07647916666666667
   968034 
   968034 Sanity check II, checking that relation between x, w, and y holds: unphased(w_i, x_i) == y_i
   968042 number of matches between sampled y and w,x per each test sample:
   968042 sample #0: 5254/6000 (87.56666666666666%)
   968042 sample #1: 5209/6000 (86.81666666666666%)
   968042 sample #2: 5251/6000 (87.51666666666667%)
   968042 sample #3: 5261/6000 (87.68333333333334%)
   968042 sample #4: 5263/6000 (87.71666666666667%)
   968042 sample #5: 5240/6000 (87.33333333333333%)
   968042 sample #6: 5240/6000 (87.33333333333333%)
   968042 sample #7: 5257/6000 (87.61666666666666%)
   968042 sample #8: 5293/6000 (88.21666666666667%)
   968042 sample #9: 5237/6000 (87.28333333333333%)
   968042 sample #10: 5257/6000 (87.61666666666666%)
   968042 sample #11: 5262/6000 (87.7%)
   968042 sample #12: 5236/6000 (87.26666666666667%)
   968042 sample #13: 5255/6000 (87.58333333333333%)
   968042 sample #14: 5256/6000 (87.6%)
   968043 sample #15: 5269/6000 (87.81666666666666%)
   968043 sample #16: 5269/6000 (87.81666666666666%)
   968043 sample #17: 5255/6000 (87.58333333333333%)
   968043 sample #18: 5230/6000 (87.16666666666667%)
   968043 sample #19: 5253/6000 (87.55%)
   968043 sample #20: 5238/6000 (87.3%)
   968043 sample #21: 5261/6000 (87.68333333333334%)
   968043 sample #22: 5237/6000 (87.28333333333333%)
   968043 sample #23: 5229/6000 (87.15%)
   968043 sample #24: 5238/6000 (87.3%)
   968043 sample #25: 5249/6000 (87.48333333333333%)
   968043 sample #26: 5249/6000 (87.48333333333333%)
   968043 sample #27: 5219/6000 (86.98333333333333%)
   968043 sample #28: 5203/6000 (86.71666666666667%)
   968043 sample #29: 5263/6000 (87.71666666666667%)
   968043 sample #30: 5208/6000 (86.8%)
   968043 sample #31: 5218/6000 (86.96666666666667%)
   968043 sample #32: 5248/6000 (87.46666666666667%)
   968043 sample #33: 5220/6000 (87.0%)
   968043 sample #34: 5273/6000 (87.88333333333334%)
   968043 sample #35: 5263/6000 (87.71666666666667%)
   968043 sample #36: 5289/6000 (88.15%)
   968043 sample #37: 5255/6000 (87.58333333333333%)
   968043 sample #38: 5224/6000 (87.06666666666666%)
   968044 sample #39: 5283/6000 (88.05%)
   968044 Measuring phasing accuracy by concordance
   969756 number of sites to phase for all sequences: [21 35 30 20 17 34 17 25 14 24 19 31 12 24 16 29 20 21 27 26 28 18 33 26
 21 23 27 19 21 15 26 27 26 12 24 21 22 22 26 23]
   969757 accuracy for all sequences: [0.         0.02857143 0.         0.         0.11764706 0.05882353
 0.         0.12       0.14285715 0.04166667 0.         0.06451613
 0.08333334 0.04166667 0.1875     0.03448276 0.1        0.04761905
 0.07407407 0.03846154 0.03571429 0.05555556 0.09090909 0.11538462
 0.0952381  0.13043478 0.03703704 0.05263158 0.04761905 0.13333334
 0.07692308 0.07407407 0.03846154 0.08333334 0.         0.14285715
 0.18181819 0.04545455 0.03846154 0.13043478]
   969757 total accuracy: 0.06616052160334496
   969757 ----------------------------------------
   969757 Measuring imputation accuracy by concordance (only for sites with at least 1 alt allele)
   969762 total non-ref sites: 27288 (11.37%)
   973138 number of non-ref sites to impute for all sequences: [632 752 647 747 622 725 504 685 622 688 738 758 487 638 555 742 572 557
 684 610 712 654 762 627 773 596 700 634 535 587 629 740 692 464 602 699
 651 624 622 654]
   973139 accuracy for all sequences: [0.03639241 0.07712766 0.04327666 0.05354752 0.02893891 0.06620689
 0.05555556 0.05693431 0.04983923 0.06104651 0.04878049 0.06200528
 0.03696099 0.05329154 0.06126126 0.06334232 0.0541958  0.03411131
 0.05263158 0.04918033 0.0505618  0.05963303 0.07086615 0.08133971
 0.06080207 0.04865772 0.06142857 0.06940063 0.05607476 0.04599659
 0.07790143 0.06351351 0.06791908 0.05387931 0.04152824 0.04434907
 0.05376344 0.06410257 0.07073955 0.05504587]
   973139 total accuracy: 0.05655427820633917
   973204 ====================Phasing test: predictive (#2)====================
   973204 sampling using predictive method
   998349 w_list shape: torch.Size([40, 6000])
   998349 x_list shape: torch.Size([40, 6000])
   998349 y_list shape: torch.Size([40, 6000])
   998350 batches: [tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39], dtype=torch.int32)]
   998391 ----------------------------------------
   998391 Sanity check I, comparing statistics from valid sequences and generated sequences:
   998392 proportion of alts in generated w_list and x_list:  0.08748333333333333	0.087875
   998394 proportion of alts in corresponding full sequences: 0.07647916666666667	0.07647916666666667
   998394 
   998394 Sanity check II, checking that relation between x, w, and y holds: unphased(w_i, x_i) == y_i
   998402 number of matches between sampled y and w,x per each test sample:
   998402 sample #0: 5247/6000 (87.45%)
   998402 sample #1: 5229/6000 (87.15%)
   998402 sample #2: 5258/6000 (87.63333333333334%)
   998402 sample #3: 5272/6000 (87.86666666666666%)
   998402 sample #4: 5207/6000 (86.78333333333333%)
   998402 sample #5: 5277/6000 (87.95%)
   998402 sample #6: 5323/6000 (88.71666666666667%)
   998402 sample #7: 5212/6000 (86.86666666666666%)
   998402 sample #8: 5246/6000 (87.43333333333334%)
   998402 sample #9: 5266/6000 (87.76666666666667%)
   998402 sample #10: 5225/6000 (87.08333333333333%)
   998403 sample #11: 5253/6000 (87.55%)
   998403 sample #12: 5307/6000 (88.45%)
   998403 sample #13: 5242/6000 (87.36666666666666%)
   998403 sample #14: 5268/6000 (87.8%)
   998403 sample #15: 5246/6000 (87.43333333333334%)
   998403 sample #16: 5254/6000 (87.56666666666666%)
   998403 sample #17: 5247/6000 (87.45%)
   998403 sample #18: 5265/6000 (87.75%)
   998403 sample #19: 5228/6000 (87.13333333333334%)
   998403 sample #20: 5259/6000 (87.65%)
   998403 sample #21: 5247/6000 (87.45%)
   998403 sample #22: 5268/6000 (87.8%)
   998403 sample #23: 5229/6000 (87.15%)
   998403 sample #24: 5260/6000 (87.66666666666667%)
   998403 sample #25: 5211/6000 (86.85%)
   998403 sample #26: 5230/6000 (87.16666666666667%)
   998403 sample #27: 5241/6000 (87.35%)
   998403 sample #28: 5239/6000 (87.31666666666666%)
   998403 sample #29: 5249/6000 (87.48333333333333%)
   998403 sample #30: 5228/6000 (87.13333333333334%)
   998403 sample #31: 5246/6000 (87.43333333333334%)
   998403 sample #32: 5174/6000 (86.23333333333333%)
   998404 sample #33: 5264/6000 (87.73333333333333%)
   998404 sample #34: 5267/6000 (87.78333333333333%)
   998404 sample #35: 5233/6000 (87.21666666666667%)
   998404 sample #36: 5232/6000 (87.2%)
   998404 sample #37: 5245/6000 (87.41666666666667%)
   998404 sample #38: 5257/6000 (87.61666666666666%)
   998404 sample #39: 5246/6000 (87.43333333333334%)
   998404 Measuring phasing accuracy by concordance
  1000115 number of sites to phase for all sequences: [21 35 30 20 17 34 17 25 14 24 19 31 12 24 16 29 20 21 27 26 28 18 33 26
 21 23 27 19 21 15 26 27 26 12 24 21 22 22 26 23]
  1000116 accuracy for all sequences: [0.0952381  0.14285715 0.1        0.1        0.         0.0882353
 0.11764706 0.16       0.14285715 0.16666667 0.15789473 0.03225806
 0.         0.16666667 0.125      0.03448276 0.1        0.14285715
 0.07407407 0.07692308 0.03571429 0.         0.12121212 0.07692308
 0.04761905 0.04347826 0.14814815 0.10526316 0.0952381  0.13333334
 0.07692308 0.03703704 0.03846154 0.         0.125      0.0952381
 0.04545455 0.13636364 0.1923077  0.08695652]
  1000116 total accuracy: 0.0932754898270079
  1000117 ----------------------------------------
  1000117 Measuring imputation accuracy by concordance (only for sites with at least 1 alt allele)
  1000121 total non-ref sites: 27288 (11.37%)
  1003497 number of non-ref sites to impute for all sequences: [632 752 647 747 622 725 504 685 622 688 738 758 487 638 555 742 572 557
 684 610 712 654 762 627 773 596 700 634 535 587 629 740 692 464 602 699
 651 624 622 654]
  1003498 accuracy for all sequences: [0.06012658 0.05718085 0.05873261 0.0562249  0.03376206 0.07310345
 0.03968254 0.06715328 0.06913184 0.06104651 0.0501355  0.05408971
 0.03285421 0.05485893 0.05405406 0.06334232 0.04020979 0.02872531
 0.05555556 0.04262295 0.05196629 0.0351682  0.0656168  0.0446571
 0.06080207 0.04530201 0.07857143 0.05678234 0.03925234 0.03577513
 0.06518283 0.06756756 0.06069364 0.0387931  0.04817276 0.04434907
 0.03840246 0.04166667 0.08038585 0.05963303]
  1003499 total accuracy: 0.053660982999433005
  1003562 ====================Phasing test: predictive (#3)====================
  1003563 sampling using predictive method
  1027394 w_list shape: torch.Size([40, 6000])
  1027394 x_list shape: torch.Size([40, 6000])
  1027394 y_list shape: torch.Size([40, 6000])
  1027396 batches: [tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39], dtype=torch.int32)]
  1027436 ----------------------------------------
  1027436 Sanity check I, comparing statistics from valid sequences and generated sequences:
  1027438 proportion of alts in generated w_list and x_list:  0.08803333333333334	0.08887916666666666
  1027439 proportion of alts in corresponding full sequences: 0.07647916666666667	0.07647916666666667
  1027439 
  1027439 Sanity check II, checking that relation between x, w, and y holds: unphased(w_i, x_i) == y_i
  1027447 number of matches between sampled y and w,x per each test sample:
  1027447 sample #0: 5250/6000 (87.5%)
  1027447 sample #1: 5228/6000 (87.13333333333334%)
  1027447 sample #2: 5223/6000 (87.05%)
  1027447 sample #3: 5263/6000 (87.71666666666667%)
  1027448 sample #4: 5284/6000 (88.06666666666666%)
  1027448 sample #5: 5249/6000 (87.48333333333333%)
  1027448 sample #6: 5245/6000 (87.41666666666667%)
  1027448 sample #7: 5267/6000 (87.78333333333333%)
  1027448 sample #8: 5251/6000 (87.51666666666667%)
  1027448 sample #9: 5245/6000 (87.41666666666667%)
  1027448 sample #10: 5247/6000 (87.45%)
  1027448 sample #11: 5227/6000 (87.11666666666666%)
  1027448 sample #12: 5315/6000 (88.58333333333333%)
  1027448 sample #13: 5271/6000 (87.85%)
  1027448 sample #14: 5194/6000 (86.56666666666666%)
  1027448 sample #15: 5259/6000 (87.65%)
  1027448 sample #16: 5244/6000 (87.4%)
  1027448 sample #17: 5229/6000 (87.15%)
  1027448 sample #18: 5232/6000 (87.2%)
  1027448 sample #19: 5229/6000 (87.15%)
  1027448 sample #20: 5263/6000 (87.71666666666667%)
  1027448 sample #21: 5213/6000 (86.88333333333334%)
  1027448 sample #22: 5205/6000 (86.75%)
  1027448 sample #23: 5246/6000 (87.43333333333334%)
  1027448 sample #24: 5256/6000 (87.6%)
  1027448 sample #25: 5281/6000 (88.01666666666667%)
  1027448 sample #26: 5288/6000 (88.13333333333334%)
  1027448 sample #27: 5255/6000 (87.58333333333333%)
  1027448 sample #28: 5280/6000 (88.0%)
  1027448 sample #29: 5260/6000 (87.66666666666667%)
  1027448 sample #30: 5214/6000 (86.9%)
  1027448 sample #31: 5253/6000 (87.55%)
  1027448 sample #32: 5242/6000 (87.36666666666666%)
  1027448 sample #33: 5208/6000 (86.8%)
  1027448 sample #34: 5252/6000 (87.53333333333333%)
  1027448 sample #35: 5257/6000 (87.61666666666666%)
  1027448 sample #36: 5282/6000 (88.03333333333333%)
  1027448 sample #37: 5292/6000 (88.2%)
  1027448 sample #38: 5225/6000 (87.08333333333333%)
  1027448 sample #39: 5255/6000 (87.58333333333333%)
  1027448 Measuring phasing accuracy by concordance
  1029175 number of sites to phase for all sequences: [21 35 30 20 17 34 17 25 14 24 19 31 12 24 16 29 20 21 27 26 28 18 33 26
 21 23 27 19 21 15 26 27 26 12 24 21 22 22 26 23]
  1029176 accuracy for all sequences: [0.14285715 0.17142858 0.16666667 0.05       0.05882353 0.11764706
 0.29411766 0.04       0.07142857 0.04166667 0.10526316 0.09677419
 0.         0.16666667 0.         0.13793103 0.05       0.04761905
 0.07407407 0.15384616 0.07142857 0.11111111 0.09090909 0.03846154
 0.04761905 0.08695652 0.03703704 0.10526316 0.0952381  0.2
 0.03846154 0.11111111 0.07692308 0.         0.04166667 0.
 0.04545455 0.04545455 0.03846154 0.04347826]
  1029176 total accuracy: 0.08568329895783917
  1029176 ----------------------------------------
  1029177 Measuring imputation accuracy by concordance (only for sites with at least 1 alt allele)
  1029181 total non-ref sites: 27288 (11.37%)
  1032560 number of non-ref sites to impute for all sequences: [632 752 647 747 622 725 504 685 622 688 738 758 487 638 555 742 572 557
 684 610 712 654 762 627 773 596 700 634 535 587 629 740 692 464 602 699
 651 624 622 654]
  1032561 accuracy for all sequences: [0.04588608 0.0731383  0.06800618 0.06693441 0.02411576 0.07448276
 0.04563492 0.05839416 0.04340836 0.05377907 0.05149052 0.07255936
 0.03696099 0.04858934 0.06126126 0.05121294 0.07342657 0.04847397
 0.05847953 0.04590164 0.0505618  0.04587156 0.07611549 0.06858055
 0.06080207 0.05033557 0.05571429 0.04258675 0.05794393 0.03918228
 0.06518283 0.06216216 0.04913295 0.04525862 0.03322259 0.04434907
 0.05222734 0.06410257 0.07234727 0.04281345]
  1032562 total accuracy: 0.05512691937641645
  1032628 ====================Phasing test: predictive (#4)====================
  1032628 sampling using predictive method
  1057118 w_list shape: torch.Size([40, 6000])
  1057118 x_list shape: torch.Size([40, 6000])
  1057118 y_list shape: torch.Size([40, 6000])
  1057120 batches: [tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39], dtype=torch.int32)]
  1057160 ----------------------------------------
  1057160 Sanity check I, comparing statistics from valid sequences and generated sequences:
  1057161 proportion of alts in generated w_list and x_list:  0.08919583333333334	0.08866666666666667
  1057162 proportion of alts in corresponding full sequences: 0.07647916666666667	0.07647916666666667
  1057162 
  1057162 Sanity check II, checking that relation between x, w, and y holds: unphased(w_i, x_i) == y_i
  1057171 number of matches between sampled y and w,x per each test sample:
  1057171 sample #0: 5279/6000 (87.98333333333333%)
  1057171 sample #1: 5242/6000 (87.36666666666666%)
  1057171 sample #2: 5259/6000 (87.65%)
  1057171 sample #3: 5248/6000 (87.46666666666667%)
  1057171 sample #4: 5288/6000 (88.13333333333334%)
  1057171 sample #5: 5220/6000 (87.0%)
  1057171 sample #6: 5252/6000 (87.53333333333333%)
  1057171 sample #7: 5244/6000 (87.4%)
  1057171 sample #8: 5239/6000 (87.31666666666666%)
  1057171 sample #9: 5227/6000 (87.11666666666666%)
  1057171 sample #10: 5282/6000 (88.03333333333333%)
  1057171 sample #11: 5230/6000 (87.16666666666667%)
  1057172 sample #12: 5279/6000 (87.98333333333333%)
  1057172 sample #13: 5255/6000 (87.58333333333333%)
  1057172 sample #14: 5207/6000 (86.78333333333333%)
  1057172 sample #15: 5219/6000 (86.98333333333333%)
  1057172 sample #16: 5258/6000 (87.63333333333334%)
  1057172 sample #17: 5231/6000 (87.18333333333334%)
  1057172 sample #18: 5251/6000 (87.51666666666667%)
  1057172 sample #19: 5246/6000 (87.43333333333334%)
  1057172 sample #20: 5266/6000 (87.76666666666667%)
  1057172 sample #21: 5215/6000 (86.91666666666667%)
  1057172 sample #22: 5231/6000 (87.18333333333334%)
  1057172 sample #23: 5249/6000 (87.48333333333333%)
  1057172 sample #24: 5265/6000 (87.75%)
  1057172 sample #25: 5242/6000 (87.36666666666666%)
  1057172 sample #26: 5292/6000 (88.2%)
  1057172 sample #27: 5248/6000 (87.46666666666667%)
  1057172 sample #28: 5280/6000 (88.0%)
  1057173 sample #29: 5191/6000 (86.51666666666667%)
  1057173 sample #30: 5221/6000 (87.01666666666667%)
  1057173 sample #31: 5298/6000 (88.3%)
  1057173 sample #32: 5294/6000 (88.23333333333333%)
  1057173 sample #33: 5323/6000 (88.71666666666667%)
  1057173 sample #34: 5250/6000 (87.5%)
  1057173 sample #35: 5239/6000 (87.31666666666666%)
  1057173 sample #36: 5238/6000 (87.3%)
  1057173 sample #37: 5263/6000 (87.71666666666667%)
  1057173 sample #38: 5260/6000 (87.66666666666667%)
  1057173 sample #39: 5274/6000 (87.9%)
  1057173 Measuring phasing accuracy by concordance
  1058899 number of sites to phase for all sequences: [21 35 30 20 17 34 17 25 14 24 19 31 12 24 16 29 20 21 27 26 28 18 33 26
 21 23 27 19 21 15 26 27 26 12 24 21 22 22 26 23]
  1058900 accuracy for all sequences: [0.14285715 0.02857143 0.         0.2        0.11764706 0.02941176
 0.05882353 0.04       0.         0.04166667 0.15789473 0.06451613
 0.         0.04166667 0.         0.13793103 0.         0.
 0.03703704 0.03846154 0.14285715 0.05555556 0.03030303 0.
 0.23809524 0.17391305 0.07407407 0.15789473 0.0952381  0.2
 0.07692308 0.03703704 0.15384616 0.08333334 0.         0.0952381
 0.13636364 0.09090909 0.03846154 0.2173913 ]
  1058900 total accuracy: 0.07809110705633678
  1058900 ----------------------------------------
  1058900 Measuring imputation accuracy by concordance (only for sites with at least 1 alt allele)
  1058904 total non-ref sites: 27288 (11.37%)
  1062272 number of non-ref sites to impute for all sequences: [632 752 647 747 622 725 504 685 622 688 738 758 487 638 555 742 572 557
 684 610 712 654 762 627 773 596 700 634 535 587 629 740 692 464 602 699
 651 624 622 654]
  1062273 accuracy for all sequences: [0.05537975 0.06117021 0.06955178 0.05087015 0.03054662 0.07310345
 0.05952381 0.0540146  0.05305466 0.06686047 0.05149052 0.05408971
 0.0698152  0.04388715 0.04144144 0.0606469  0.0506993  0.04308797
 0.04239766 0.06229508 0.05477528 0.05657492 0.07611549 0.07017544
 0.06468305 0.04530201 0.08142857 0.05678234 0.04485981 0.0374787
 0.0381558  0.07567567 0.05924856 0.04094828 0.03322259 0.04148784
 0.07680491 0.04647436 0.07395498 0.05657492]
  1062273 total accuracy: 0.056168505461795554
  1062338 ====================Phasing test: predictive (#5)====================
  1062338 sampling using predictive method
  1086344 w_list shape: torch.Size([40, 6000])
  1086344 x_list shape: torch.Size([40, 6000])
  1086344 y_list shape: torch.Size([40, 6000])
  1086348 batches: [tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39], dtype=torch.int32)]
  1086387 ----------------------------------------
  1086387 Sanity check I, comparing statistics from valid sequences and generated sequences:
  1086388 proportion of alts in generated w_list and x_list:  0.08770416666666667	0.0895875
  1086389 proportion of alts in corresponding full sequences: 0.07647916666666667	0.07647916666666667
  1086389 
  1086389 Sanity check II, checking that relation between x, w, and y holds: unphased(w_i, x_i) == y_i
  1086397 number of matches between sampled y and w,x per each test sample:
  1086397 sample #0: 5221/6000 (87.01666666666667%)
  1086397 sample #1: 5282/6000 (88.03333333333333%)
  1086397 sample #2: 5232/6000 (87.2%)
  1086397 sample #3: 5235/6000 (87.25%)
  1086397 sample #4: 5260/6000 (87.66666666666667%)
  1086398 sample #5: 5211/6000 (86.85%)
  1086398 sample #6: 5266/6000 (87.76666666666667%)
  1086398 sample #7: 5246/6000 (87.43333333333334%)
  1086398 sample #8: 5226/6000 (87.1%)
  1086398 sample #9: 5247/6000 (87.45%)
  1086398 sample #10: 5284/6000 (88.06666666666666%)
  1086398 sample #11: 5244/6000 (87.4%)
  1086398 sample #12: 5218/6000 (86.96666666666667%)
  1086398 sample #13: 5246/6000 (87.43333333333334%)
  1086398 sample #14: 5289/6000 (88.15%)
  1086398 sample #15: 5282/6000 (88.03333333333333%)
  1086398 sample #16: 5254/6000 (87.56666666666666%)
  1086398 sample #17: 5207/6000 (86.78333333333333%)
  1086398 sample #18: 5235/6000 (87.25%)
  1086398 sample #19: 5212/6000 (86.86666666666666%)
  1086398 sample #20: 5198/6000 (86.63333333333334%)
  1086398 sample #21: 5224/6000 (87.06666666666666%)
  1086398 sample #22: 5228/6000 (87.13333333333334%)
  1086398 sample #23: 5206/6000 (86.76666666666667%)
  1086398 sample #24: 5270/6000 (87.83333333333333%)
  1086398 sample #25: 5243/6000 (87.38333333333334%)
  1086398 sample #26: 5202/6000 (86.7%)
  1086398 sample #27: 5266/6000 (87.76666666666667%)
  1086398 sample #28: 5196/6000 (86.6%)
  1086398 sample #29: 5263/6000 (87.71666666666667%)
  1086399 sample #30: 5255/6000 (87.58333333333333%)
  1086399 sample #31: 5234/6000 (87.23333333333333%)
  1086399 sample #32: 5229/6000 (87.15%)
  1086399 sample #33: 5208/6000 (86.8%)
  1086399 sample #34: 5239/6000 (87.31666666666666%)
  1086399 sample #35: 5228/6000 (87.13333333333334%)
  1086399 sample #36: 5246/6000 (87.43333333333334%)
  1086399 sample #37: 5243/6000 (87.38333333333334%)
  1086399 sample #38: 5276/6000 (87.93333333333334%)
  1086399 sample #39: 5257/6000 (87.61666666666666%)
  1086399 Measuring phasing accuracy by concordance
  1088124 number of sites to phase for all sequences: [21 35 30 20 17 34 17 25 14 24 19 31 12 24 16 29 20 21 27 26 28 18 33 26
 21 23 27 19 21 15 26 27 26 12 24 21 22 22 26 23]
  1088125 accuracy for all sequences: [0.04761905 0.05714286 0.03333334 0.         0.05882353 0.02941176
 0.         0.12       0.07142857 0.125      0.05263158 0.06451613
 0.16666667 0.04166667 0.         0.06896552 0.         0.04761905
 0.11111111 0.03846154 0.07142857 0.05555556 0.03030303 0.11538462
 0.04761905 0.         0.03703704 0.05263158 0.04761905 0.2
 0.03846154 0.14814815 0.03846154 0.16666667 0.04166667 0.14285715
 0.13636364 0.         0.         0.08695652]
  1088125 total accuracy: 0.06182212675487271
  1088125 ----------------------------------------
  1088125 Measuring imputation accuracy by concordance (only for sites with at least 1 alt allele)
  1088129 total non-ref sites: 27288 (11.37%)
  1091506 number of non-ref sites to impute for all sequences: [632 752 647 747 622 725 504 685 622 688 738 758 487 638 555 742 572 557
 684 610 712 654 762 627 773 596 700 634 535 587 629 740 692 464 602 699
 651 624 622 654]
  1091507 accuracy for all sequences: [0.05537975 0.07180851 0.04173107 0.0562249  0.03697749 0.09103448
 0.0515873  0.04671533 0.05948553 0.07558139 0.05826558 0.05408971
 0.03901437 0.06269593 0.06846847 0.06199461 0.04370629 0.03590664
 0.05701754 0.05737705 0.06601124 0.05351682 0.06692913 0.07017544
 0.07115136 0.04530201 0.07857143 0.05678234 0.03925234 0.03236797
 0.07472178 0.05675676 0.06791908 0.04310345 0.04152824 0.06008584
 0.05990783 0.05448718 0.06913184 0.04281345]
  1091507 total accuracy: 0.05775017385251678
  1091575 ====================Phasing test: predictive (#6)====================
  1091575 sampling using predictive method
  1114970 w_list shape: torch.Size([40, 6000])
  1114970 x_list shape: torch.Size([40, 6000])
  1114970 y_list shape: torch.Size([40, 6000])
  1114974 batches: [tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39], dtype=torch.int32)]
  1115013 ----------------------------------------
  1115014 Sanity check I, comparing statistics from valid sequences and generated sequences:
  1115015 proportion of alts in generated w_list and x_list:  0.08715	0.08882916666666667
  1115016 proportion of alts in corresponding full sequences: 0.07647916666666667	0.07647916666666667
  1115017 
  1115017 Sanity check II, checking that relation between x, w, and y holds: unphased(w_i, x_i) == y_i
  1115025 number of matches between sampled y and w,x per each test sample:
  1115025 sample #0: 5268/6000 (87.8%)
  1115025 sample #1: 5229/6000 (87.15%)
  1115025 sample #2: 5247/6000 (87.45%)
  1115025 sample #3: 5255/6000 (87.58333333333333%)
  1115025 sample #4: 5203/6000 (86.71666666666667%)
  1115025 sample #5: 5244/6000 (87.4%)
  1115025 sample #6: 5282/6000 (88.03333333333333%)
  1115025 sample #7: 5239/6000 (87.31666666666666%)
  1115025 sample #8: 5267/6000 (87.78333333333333%)
  1115026 sample #9: 5235/6000 (87.25%)
  1115026 sample #10: 5266/6000 (87.76666666666667%)
  1115026 sample #11: 5207/6000 (86.78333333333333%)
  1115026 sample #12: 5219/6000 (86.98333333333333%)
  1115026 sample #13: 5281/6000 (88.01666666666667%)
  1115026 sample #14: 5253/6000 (87.55%)
  1115026 sample #15: 5258/6000 (87.63333333333334%)
  1115026 sample #16: 5286/6000 (88.1%)
  1115026 sample #17: 5248/6000 (87.46666666666667%)
  1115026 sample #18: 5261/6000 (87.68333333333334%)
  1115026 sample #19: 5259/6000 (87.65%)
  1115026 sample #20: 5253/6000 (87.55%)
  1115026 sample #21: 5243/6000 (87.38333333333334%)
  1115026 sample #22: 5201/6000 (86.68333333333334%)
  1115026 sample #23: 5284/6000 (88.06666666666666%)
  1115026 sample #24: 5285/6000 (88.08333333333333%)
  1115026 sample #25: 5214/6000 (86.9%)
  1115027 sample #26: 5286/6000 (88.1%)
  1115027 sample #27: 5270/6000 (87.83333333333333%)
  1115027 sample #28: 5232/6000 (87.2%)
  1115027 sample #29: 5264/6000 (87.73333333333333%)
  1115027 sample #30: 5276/6000 (87.93333333333334%)
  1115027 sample #31: 5239/6000 (87.31666666666666%)
  1115027 sample #32: 5255/6000 (87.58333333333333%)
  1115027 sample #33: 5246/6000 (87.43333333333334%)
  1115027 sample #34: 5249/6000 (87.48333333333333%)
  1115027 sample #35: 5262/6000 (87.7%)
  1115027 sample #36: 5281/6000 (88.01666666666667%)
  1115027 sample #37: 5253/6000 (87.55%)
  1115027 sample #38: 5255/6000 (87.58333333333333%)
  1115027 sample #39: 5292/6000 (88.2%)
  1115027 Measuring phasing accuracy by concordance
  1116742 number of sites to phase for all sequences: [21 35 30 20 17 34 17 25 14 24 19 31 12 24 16 29 20 21 27 26 28 18 33 26
 21 23 27 19 21 15 26 27 26 12 24 21 22 22 26 23]
  1116743 accuracy for all sequences: [0.0952381  0.14285715 0.1        0.1        0.05882353 0.02941176
 0.05882353 0.12       0.21428572 0.04166667 0.05263158 0.06451613
 0.16666667 0.08333334 0.0625     0.1724138  0.05       0.
 0.11111111 0.03846154 0.         0.05555556 0.         0.15384616
 0.0952381  0.04347826 0.07407407 0.05263158 0.14285715 0.13333334
 0.07692308 0.03703704 0.07692308 0.25       0.08333334 0.04761905
 0.09090909 0.09090909 0.03846154 0.17391305]
  1116743 total accuracy: 0.08242950272097896
  1116743 ----------------------------------------
  1116743 Measuring imputation accuracy by concordance (only for sites with at least 1 alt allele)
  1116748 total non-ref sites: 27288 (11.37%)
  1120119 number of non-ref sites to impute for all sequences: [632 752 647 747 622 725 504 685 622 688 738 758 487 638 555 742 572 557
 684 610 712 654 762 627 773 596 700 634 535 587 629 740 692 464 602 699
 651 624 622 654]
  1120119 accuracy for all sequences: [0.04113924 0.04787234 0.06646059 0.05220884 0.03536978 0.05655172
 0.03968254 0.06423358 0.04180064 0.07848837 0.06504065 0.06200528
 0.04312115 0.05172414 0.04504504 0.0458221  0.06293707 0.0448833
 0.05847953 0.07377049 0.06460674 0.05045871 0.06824147 0.04625199
 0.06209573 0.04865772 0.05857143 0.03785489 0.05420561 0.0374787
 0.05882353 0.09594595 0.06358381 0.06465517 0.05149502 0.03862661
 0.05529954 0.0625     0.0562701  0.05504587]
  1120120 total accuracy: 0.055705578665757566
  1120184 ====================Phasing test: predictive (#7)====================
  1120184 sampling using predictive method
  1144035 w_list shape: torch.Size([40, 6000])
  1144035 x_list shape: torch.Size([40, 6000])
  1144035 y_list shape: torch.Size([40, 6000])
  1144037 batches: [tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39], dtype=torch.int32)]
  1144076 ----------------------------------------
  1144076 Sanity check I, comparing statistics from valid sequences and generated sequences:
  1144077 proportion of alts in generated w_list and x_list:  0.0897625	0.08950833333333333
  1144079 proportion of alts in corresponding full sequences: 0.07647916666666667	0.07647916666666667
  1144079 
  1144079 Sanity check II, checking that relation between x, w, and y holds: unphased(w_i, x_i) == y_i
  1144087 number of matches between sampled y and w,x per each test sample:
  1144088 sample #0: 5235/6000 (87.25%)
  1144088 sample #1: 5282/6000 (88.03333333333333%)
  1144088 sample #2: 5262/6000 (87.7%)
  1144088 sample #3: 5262/6000 (87.7%)
  1144088 sample #4: 5265/6000 (87.75%)
  1144088 sample #5: 5202/6000 (86.7%)
  1144088 sample #6: 5241/6000 (87.35%)
  1144088 sample #7: 5287/6000 (88.11666666666666%)
  1144088 sample #8: 5236/6000 (87.26666666666667%)
  1144088 sample #9: 5248/6000 (87.46666666666667%)
  1144088 sample #10: 5276/6000 (87.93333333333334%)
  1144088 sample #11: 5249/6000 (87.48333333333333%)
  1144088 sample #12: 5267/6000 (87.78333333333333%)
  1144088 sample #13: 5272/6000 (87.86666666666666%)
  1144088 sample #14: 5297/6000 (88.28333333333333%)
  1144089 sample #15: 5237/6000 (87.28333333333333%)
  1144089 sample #16: 5233/6000 (87.21666666666667%)
  1144089 sample #17: 5250/6000 (87.5%)
  1144089 sample #18: 5246/6000 (87.43333333333334%)
  1144089 sample #19: 5239/6000 (87.31666666666666%)
  1144089 sample #20: 5276/6000 (87.93333333333334%)
  1144089 sample #21: 5224/6000 (87.06666666666666%)
  1144089 sample #22: 5271/6000 (87.85%)
  1144089 sample #23: 5266/6000 (87.76666666666667%)
  1144089 sample #24: 5274/6000 (87.9%)
  1144089 sample #25: 5222/6000 (87.03333333333333%)
  1144089 sample #26: 5226/6000 (87.1%)
  1144089 sample #27: 5218/6000 (86.96666666666667%)
  1144089 sample #28: 5276/6000 (87.93333333333334%)
  1144089 sample #29: 5276/6000 (87.93333333333334%)
  1144089 sample #30: 5239/6000 (87.31666666666666%)
  1144089 sample #31: 5267/6000 (87.78333333333333%)
  1144089 sample #32: 5255/6000 (87.58333333333333%)
  1144090 sample #33: 5224/6000 (87.06666666666666%)
  1144090 sample #34: 5253/6000 (87.55%)
  1144090 sample #35: 5240/6000 (87.33333333333333%)
  1144090 sample #36: 5249/6000 (87.48333333333333%)
  1144090 sample #37: 5200/6000 (86.66666666666667%)
  1144090 sample #38: 5294/6000 (88.23333333333333%)
  1144090 sample #39: 5235/6000 (87.25%)
  1144090 Measuring phasing accuracy by concordance
  1145800 number of sites to phase for all sequences: [21 35 30 20 17 34 17 25 14 24 19 31 12 24 16 29 20 21 27 26 28 18 33 26
 21 23 27 19 21 15 26 27 26 12 24 21 22 22 26 23]
  1145801 accuracy for all sequences: [0.         0.08571429 0.2        0.05       0.         0.02941176
 0.1764706  0.16       0.07142857 0.16666667 0.         0.06451613
 0.         0.125      0.0625     0.13793103 0.25       0.0952381
 0.14814815 0.03846154 0.07142857 0.05555556 0.12121212 0.11538462
 0.         0.08695652 0.07407407 0.         0.04761905 0.2
 0.03846154 0.07407407 0.03846154 0.08333334 0.125      0.0952381
 0.04545455 0.18181819 0.07692308 0.04347826]
  1145802 total accuracy: 0.08785249578509956
  1145802 ----------------------------------------
  1145802 Measuring imputation accuracy by concordance (only for sites with at least 1 alt allele)
  1145806 total non-ref sites: 27288 (11.37%)
  1149191 number of non-ref sites to impute for all sequences: [632 752 647 747 622 725 504 685 622 688 738 758 487 638 555 742 572 557
 684 610 712 654 762 627 773 596 700 634 535 587 629 740 692 464 602 699
 651 624 622 654]
  1149192 accuracy for all sequences: [0.05063291 0.07579787 0.04327666 0.04417671 0.03376206 0.06206897
 0.05357143 0.06131387 0.04823151 0.05377907 0.05420054 0.05804749
 0.05338809 0.05329154 0.05405406 0.07008086 0.05594406 0.03770198
 0.0628655  0.06721312 0.06179775 0.04740061 0.05905512 0.05582137
 0.08279431 0.04026845 0.07571428 0.0615142  0.05046729 0.03407155
 0.05564388 0.0554054  0.07514451 0.05603448 0.04983389 0.04434907
 0.05837174 0.05769231 0.07877813 0.06269113]
  1149192 total accuracy: 0.05694005055308927
  1149256 ====================Phasing test: predictive (#8)====================
  1149256 sampling using predictive method
  1173879 w_list shape: torch.Size([40, 6000])
  1173879 x_list shape: torch.Size([40, 6000])
  1173879 y_list shape: torch.Size([40, 6000])
  1173881 batches: [tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39], dtype=torch.int32)]
  1173921 ----------------------------------------
  1173921 Sanity check I, comparing statistics from valid sequences and generated sequences:
  1173922 proportion of alts in generated w_list and x_list:  0.087775	0.089875
  1173923 proportion of alts in corresponding full sequences: 0.07647916666666667	0.07647916666666667
  1173924 
  1173924 Sanity check II, checking that relation between x, w, and y holds: unphased(w_i, x_i) == y_i
  1173933 number of matches between sampled y and w,x per each test sample:
  1173934 sample #0: 5240/6000 (87.33333333333333%)
  1173934 sample #1: 5234/6000 (87.23333333333333%)
  1173934 sample #2: 5253/6000 (87.55%)
  1173934 sample #3: 5279/6000 (87.98333333333333%)
  1173934 sample #4: 5264/6000 (87.73333333333333%)
  1173934 sample #5: 5260/6000 (87.66666666666667%)
  1173934 sample #6: 5268/6000 (87.8%)
  1173934 sample #7: 5229/6000 (87.15%)
  1173934 sample #8: 5229/6000 (87.15%)
  1173934 sample #9: 5253/6000 (87.55%)
  1173934 sample #10: 5245/6000 (87.41666666666667%)
  1173934 sample #11: 5273/6000 (87.88333333333334%)
  1173934 sample #12: 5317/6000 (88.61666666666666%)
  1173934 sample #13: 5216/6000 (86.93333333333334%)
  1173934 sample #14: 5269/6000 (87.81666666666666%)
  1173934 sample #15: 5272/6000 (87.86666666666666%)
  1173934 sample #16: 5228/6000 (87.13333333333334%)
  1173934 sample #17: 5272/6000 (87.86666666666666%)
  1173935 sample #18: 5268/6000 (87.8%)
  1173935 sample #19: 5268/6000 (87.8%)
  1173935 sample #20: 5247/6000 (87.45%)
  1173935 sample #21: 5280/6000 (88.0%)
  1173935 sample #22: 5264/6000 (87.73333333333333%)
  1173935 sample #23: 5221/6000 (87.01666666666667%)
  1173935 sample #24: 5240/6000 (87.33333333333333%)
  1173935 sample #25: 5239/6000 (87.31666666666666%)
  1173935 sample #26: 5249/6000 (87.48333333333333%)
  1173935 sample #27: 5314/6000 (88.56666666666666%)
  1173935 sample #28: 5242/6000 (87.36666666666666%)
  1173935 sample #29: 5216/6000 (86.93333333333334%)
  1173935 sample #30: 5218/6000 (86.96666666666667%)
  1173935 sample #31: 5203/6000 (86.71666666666667%)
  1173935 sample #32: 5216/6000 (86.93333333333334%)
  1173935 sample #33: 5266/6000 (87.76666666666667%)
  1173935 sample #34: 5243/6000 (87.38333333333334%)
  1173936 sample #35: 5286/6000 (88.1%)
  1173936 sample #36: 5263/6000 (87.71666666666667%)
  1173936 sample #37: 5256/6000 (87.6%)
  1173936 sample #38: 5253/6000 (87.55%)
  1173936 sample #39: 5258/6000 (87.63333333333334%)
  1173936 Measuring phasing accuracy by concordance
  1175658 number of sites to phase for all sequences: [21 35 30 20 17 34 17 25 14 24 19 31 12 24 16 29 20 21 27 26 28 18 33 26
 21 23 27 19 21 15 26 27 26 12 24 21 22 22 26 23]
  1175659 accuracy for all sequences: [0.0952381  0.02857143 0.1        0.1        0.05882353 0.05882353
 0.23529412 0.2        0.07142857 0.04166667 0.10526316 0.06451613
 0.         0.04166667 0.0625     0.10344828 0.2        0.
 0.07407407 0.07692308 0.03571429 0.16666667 0.09090909 0.11538462
 0.0952381  0.         0.07407407 0.05263158 0.14285715 0.
 0.1923077  0.03703704 0.03846154 0.         0.04166667 0.14285715
 0.         0.         0.         0.04347826]
  1175659 total accuracy: 0.07483731157503973
  1175659 ----------------------------------------
  1175659 Measuring imputation accuracy by concordance (only for sites with at least 1 alt allele)
  1175663 total non-ref sites: 27288 (11.37%)
  1179049 number of non-ref sites to impute for all sequences: [632 752 647 747 622 725 504 685 622 688 738 758 487 638 555 742 572 557
 684 610 712 654 762 627 773 596 700 634 535 587 629 740 692 464 602 699
 651 624 622 654]
  1179050 accuracy for all sequences: [0.03639241 0.06382979 0.07264297 0.05220884 0.02893891 0.06344827
 0.03769841 0.06131387 0.05144694 0.07122093 0.06368563 0.06596306
 0.02874743 0.05642633 0.04504504 0.05525606 0.0506993  0.0448833
 0.0497076  0.05245902 0.04353933 0.04892967 0.07611549 0.04784689
 0.05174644 0.04194631 0.05571429 0.05205048 0.04859813 0.03918228
 0.05246423 0.06621622 0.06358381 0.06465517 0.04152824 0.05007153
 0.05376344 0.06410257 0.0659164  0.07492355]
  1179050 total accuracy: 0.054548260039578696
  1179115 ====================Phasing test: infer_discrete (#1)====================
  1179115 sampling using infer_discrete method
  1264238 w_list shape: torch.Size([40, 6000])
  1264238 x_list shape: torch.Size([40, 6000])
  1264238 y_list shape: torch.Size([40, 6000])
  1264239 batches: [tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39])]
  1264239 ----------------------------------------
  1264239 Sanity check I, comparing statistics from valid sequences and generated sequences:
  1264240 proportion of alts in generated w_list and x_list:  0.00185	0.005691666666666667
  1264241 proportion of alts in corresponding full sequences: 0.07647916666666667	0.07647916666666667
  1264241 
  1264241 Sanity check II, checking that relation between x, w, and y holds: unphased(w_i, x_i) == y_i
  1264250 number of matches between sampled y and w,x per each test sample:
  1264250 sample #0: 6000/6000 (100.0%)
  1264250 sample #1: 6000/6000 (100.0%)
  1264250 sample #2: 6000/6000 (100.0%)
  1264250 sample #3: 6000/6000 (100.0%)
  1264250 sample #4: 6000/6000 (100.0%)
  1264250 sample #5: 6000/6000 (100.0%)
  1264250 sample #6: 6000/6000 (100.0%)
  1264250 sample #7: 6000/6000 (100.0%)
  1264250 sample #8: 6000/6000 (100.0%)
  1264250 sample #9: 6000/6000 (100.0%)
  1264250 sample #10: 6000/6000 (100.0%)
  1264250 sample #11: 6000/6000 (100.0%)
  1264250 sample #12: 6000/6000 (100.0%)
  1264250 sample #13: 6000/6000 (100.0%)
  1264251 sample #14: 6000/6000 (100.0%)
  1264251 sample #15: 6000/6000 (100.0%)
  1264251 sample #16: 6000/6000 (100.0%)
  1264251 sample #17: 6000/6000 (100.0%)
  1264251 sample #18: 6000/6000 (100.0%)
  1264251 sample #19: 6000/6000 (100.0%)
  1264251 sample #20: 6000/6000 (100.0%)
  1264251 sample #21: 6000/6000 (100.0%)
  1264251 sample #22: 6000/6000 (100.0%)
  1264251 sample #23: 6000/6000 (100.0%)
  1264251 sample #24: 6000/6000 (100.0%)
  1264251 sample #25: 6000/6000 (100.0%)
  1264251 sample #26: 6000/6000 (100.0%)
  1264251 sample #27: 6000/6000 (100.0%)
  1264251 sample #28: 6000/6000 (100.0%)
  1264251 sample #29: 6000/6000 (100.0%)
  1264251 sample #30: 6000/6000 (100.0%)
  1264251 sample #31: 6000/6000 (100.0%)
  1264251 sample #32: 6000/6000 (100.0%)
  1264251 sample #33: 6000/6000 (100.0%)
  1264251 sample #34: 6000/6000 (100.0%)
  1264251 sample #35: 6000/6000 (100.0%)
  1264251 sample #36: 6000/6000 (100.0%)
  1264251 sample #37: 6000/6000 (100.0%)
  1264251 sample #38: 6000/6000 (100.0%)
  1264251 sample #39: 6000/6000 (100.0%)
  1264251 Measuring phasing accuracy by concordance
  1266020 number of sites to phase for all sequences: [21 35 30 20 17 34 17 25 14 24 19 31 12 24 16 29 20 21 27 26 28 18 33 26
 21 23 27 19 21 15 26 27 26 12 24 21 22 22 26 23]
  1266021 accuracy for all sequences: [0.52380955 0.4        0.6333333  0.45       0.29411766 0.5
 0.29411766 0.56       0.71428573 0.5        0.5263158  0.516129
 1.         0.375      0.8125     0.44827586 0.45       0.6666667
 0.5925926  0.46153846 0.53571427 0.6111111  0.57575756 0.53846157
 0.61904764 0.73913044 0.5185185  0.57894737 0.52380955 0.6666667
 0.5        0.4814815  0.34615386 0.5833333  0.45833334 0.61904764
 0.54545456 0.27272728 0.61538464 0.39130434]
  1266021 total accuracy: 0.5249457745903742
  1266021 ----------------------------------------
  1266021 Measuring imputation accuracy by concordance (only for sites with at least 1 alt allele)
  1266026 total non-ref sites: 27288 (11.37%)
  1269380 number of non-ref sites to impute for all sequences: [632 752 647 747 622 725 504 685 622 688 738 758 487 638 555 742 572 557
 684 610 712 654 762 627 773 596 700 634 535 587 629 740 692 464 602 699
 651 624 622 654]
  1269381 accuracy for all sequences: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
  1269381 total accuracy: 0.0
  1269439 ====================Phasing test: infer_discrete (#2)====================
  1269439 sampling using infer_discrete method
  1301661 w_list shape: torch.Size([40, 6000])
  1301661 x_list shape: torch.Size([40, 6000])
  1301661 y_list shape: torch.Size([40, 6000])
  1301662 batches: [tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39])]
  1301662 ----------------------------------------
  1301662 Sanity check I, comparing statistics from valid sequences and generated sequences:
  1301663 proportion of alts in generated w_list and x_list:  0.0037083333333333334	0.000275
  1301664 proportion of alts in corresponding full sequences: 0.07647916666666667	0.07647916666666667
  1301664 
  1301664 Sanity check II, checking that relation between x, w, and y holds: unphased(w_i, x_i) == y_i
  1301673 number of matches between sampled y and w,x per each test sample:
  1301673 sample #0: 5986/6000 (99.76666666666667%)
  1301673 sample #1: 5995/6000 (99.91666666666667%)
  1301673 sample #2: 5991/6000 (99.85%)
  1301673 sample #3: 5986/6000 (99.76666666666667%)
  1301673 sample #4: 5984/6000 (99.73333333333333%)
  1301673 sample #5: 5992/6000 (99.86666666666666%)
  1301673 sample #6: 5990/6000 (99.83333333333333%)
  1301673 sample #7: 5990/6000 (99.83333333333333%)
  1301673 sample #8: 5983/6000 (99.71666666666667%)
  1301673 sample #9: 5990/6000 (99.83333333333333%)
  1301673 sample #10: 5982/6000 (99.7%)
  1301674 sample #11: 5986/6000 (99.76666666666667%)
  1301674 sample #12: 5992/6000 (99.86666666666666%)
  1301674 sample #13: 5988/6000 (99.8%)
  1301674 sample #14: 5989/6000 (99.81666666666666%)
  1301674 sample #15: 5990/6000 (99.83333333333333%)
  1301674 sample #16: 5992/6000 (99.86666666666666%)
  1301674 sample #17: 5983/6000 (99.71666666666667%)
  1301674 sample #18: 5991/6000 (99.85%)
  1301674 sample #19: 5988/6000 (99.8%)
  1301674 sample #20: 5992/6000 (99.86666666666666%)
  1301674 sample #21: 5985/6000 (99.75%)
  1301674 sample #22: 5994/6000 (99.9%)
  1301674 sample #23: 5991/6000 (99.85%)
  1301674 sample #24: 5988/6000 (99.8%)
  1301674 sample #25: 5985/6000 (99.75%)
  1301674 sample #26: 5991/6000 (99.85%)
  1301674 sample #27: 5986/6000 (99.76666666666667%)
  1301674 sample #28: 5989/6000 (99.81666666666666%)
  1301674 sample #29: 5984/6000 (99.73333333333333%)
  1301674 sample #30: 5991/6000 (99.85%)
  1301674 sample #31: 5990/6000 (99.83333333333333%)
  1301674 sample #32: 5994/6000 (99.9%)
  1301674 sample #33: 5987/6000 (99.78333333333333%)
  1301675 sample #34: 5989/6000 (99.81666666666666%)
  1301675 sample #35: 5986/6000 (99.76666666666667%)
  1301675 sample #36: 5991/6000 (99.85%)
  1301675 sample #37: 5990/6000 (99.83333333333333%)
  1301675 sample #38: 5994/6000 (99.9%)
  1301675 sample #39: 5991/6000 (99.85%)
  1301675 Measuring phasing accuracy by concordance
  1303406 number of sites to phase for all sequences: [21 35 30 20 17 34 17 25 14 24 19 31 12 24 16 29 20 21 27 26 28 18 33 26
 21 23 27 19 21 15 26 27 26 12 24 21 22 22 26 23]
  1303407 accuracy for all sequences: [0.47619048 0.54285717 0.36666667 0.55       0.7058824  0.5
 0.7058824  0.44       0.2857143  0.5        0.47368422 0.48387095
 0.         0.625      0.1875     0.4827586  0.55       0.33333334
 0.4074074  0.53846157 0.39285713 0.5        0.42424244 0.46153846
 0.47619048 0.26086956 0.4814815  0.5263158  0.47619048 0.33333334
 0.5769231  0.5185185  0.65384614 0.41666666 0.5416667  0.3809524
 0.54545456 0.6363636  0.3846154  0.5217391 ]
  1303407 total accuracy: 0.47505423404001607
  1303407 ----------------------------------------
  1303407 Measuring imputation accuracy by concordance (only for sites with at least 1 alt allele)
  1303412 total non-ref sites: 27288 (11.37%)
  1306685 number of non-ref sites to impute for all sequences: [632 752 647 747 622 725 504 685 622 688 738 758 487 638 555 742 572 557
 684 610 712 654 762 627 773 596 700 634 535 587 629 740 692 464 602 699
 651 624 622 654]
  1306686 accuracy for all sequences: [0.         0.         0.         0.         0.         0.
 0.         0.00145985 0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.00158983 0.         0.         0.         0.         0.
 0.         0.         0.         0.        ]
  1306686 total accuracy: 7.71545396105861e-05
  1306745 ====================Phasing test: infer_discrete (#3)====================
  1306746 sampling using infer_discrete method
  1338711 w_list shape: torch.Size([40, 6000])
  1338712 x_list shape: torch.Size([40, 6000])
  1338712 y_list shape: torch.Size([40, 6000])
  1338712 batches: [tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39])]
  1338712 ----------------------------------------
  1338713 Sanity check I, comparing statistics from valid sequences and generated sequences:
  1338714 proportion of alts in generated w_list and x_list:  0.4953958333333333	0.00185
  1338715 proportion of alts in corresponding full sequences: 0.07647916666666667	0.07647916666666667
  1338715 
  1338715 Sanity check II, checking that relation between x, w, and y holds: unphased(w_i, x_i) == y_i
  1338724 number of matches between sampled y and w,x per each test sample:
  1338724 sample #0: 6000/6000 (100.0%)
  1338724 sample #1: 6000/6000 (100.0%)
  1338724 sample #2: 6000/6000 (100.0%)
  1338724 sample #3: 6000/6000 (100.0%)
  1338724 sample #4: 6000/6000 (100.0%)
  1338724 sample #5: 6000/6000 (100.0%)
  1338724 sample #6: 6000/6000 (100.0%)
  1338724 sample #7: 6000/6000 (100.0%)
  1338724 sample #8: 6000/6000 (100.0%)
  1338724 sample #9: 6000/6000 (100.0%)
  1338724 sample #10: 6000/6000 (100.0%)
  1338724 sample #11: 6000/6000 (100.0%)
  1338724 sample #12: 6000/6000 (100.0%)
  1338724 sample #13: 6000/6000 (100.0%)
  1338724 sample #14: 6000/6000 (100.0%)
  1338725 sample #15: 6000/6000 (100.0%)
  1338725 sample #16: 6000/6000 (100.0%)
  1338725 sample #17: 6000/6000 (100.0%)
  1338725 sample #18: 6000/6000 (100.0%)
  1338725 sample #19: 6000/6000 (100.0%)
  1338725 sample #20: 6000/6000 (100.0%)
  1338725 sample #21: 6000/6000 (100.0%)
  1338725 sample #22: 6000/6000 (100.0%)
  1338725 sample #23: 6000/6000 (100.0%)
  1338725 sample #24: 6000/6000 (100.0%)
  1338725 sample #25: 6000/6000 (100.0%)
  1338725 sample #26: 6000/6000 (100.0%)
  1338725 sample #27: 6000/6000 (100.0%)
  1338725 sample #28: 6000/6000 (100.0%)
  1338725 sample #29: 6000/6000 (100.0%)
  1338725 sample #30: 6000/6000 (100.0%)
  1338725 sample #31: 6000/6000 (100.0%)
  1338725 sample #32: 6000/6000 (100.0%)
  1338725 sample #33: 6000/6000 (100.0%)
  1338725 sample #34: 6000/6000 (100.0%)
  1338726 sample #35: 6000/6000 (100.0%)
  1338726 sample #36: 6000/6000 (100.0%)
  1338726 sample #37: 6000/6000 (100.0%)
  1338726 sample #38: 6000/6000 (100.0%)
  1338726 sample #39: 6000/6000 (100.0%)
  1338726 Measuring phasing accuracy by concordance
  1340441 number of sites to phase for all sequences: [21 35 30 20 17 34 17 25 14 24 19 31 12 24 16 29 20 21 27 26 28 18 33 26
 21 23 27 19 21 15 26 27 26 12 24 21 22 22 26 23]
  1340442 accuracy for all sequences: [0.47619048 0.6        0.36666667 0.55       0.7058824  0.5
 0.7058824  0.44       0.2857143  0.5        0.47368422 0.48387095
 0.         0.625      0.1875     0.55172414 0.55       0.33333334
 0.4074074  0.53846157 0.4642857  0.3888889  0.42424244 0.46153846
 0.3809524  0.26086956 0.4814815  0.42105263 0.47619048 0.33333334
 0.5        0.5185185  0.65384614 0.41666666 0.5416667  0.3809524
 0.45454547 0.72727275 0.3846154  0.6086956 ]
  1340442 total accuracy: 0.4750542342662809
  1340442 ----------------------------------------
  1340443 Measuring imputation accuracy by concordance (only for sites with at least 1 alt allele)
  1340447 total non-ref sites: 27288 (11.37%)
  1343756 number of non-ref sites to impute for all sequences: [632 752 647 747 622 725 504 685 622 688 738 758 487 638 555 742 572 557
 684 610 712 654 762 627 773 596 700 634 535 587 629 740 692 464 602 699
 651 624 622 654]
  1343757 accuracy for all sequences: [0.15822785 0.26462767 0.1885626  0.13922356 0.11414791 0.20275863
 0.17857143 0.16788322 0.13826367 0.1875     0.18428184 0.18205805
 0.02258727 0.20376176 0.1009009  0.1981132  0.1590909  0.11131059
 0.0877193  0.23278688 0.17275281 0.1146789  0.18897638 0.14832535
 0.16429496 0.09731544 0.20428571 0.170347   0.12523365 0.12776831
 0.15739268 0.20405406 0.20520231 0.12284483 0.19767442 0.12875536
 0.13671274 0.20673077 0.20900321 0.18348624]
  1343758 total accuracy: 0.16491783068880891
  1343820 ====================Phasing test: infer_discrete (#4)====================
  1343820 sampling using infer_discrete method
  1376827 w_list shape: torch.Size([40, 6000])
  1376827 x_list shape: torch.Size([40, 6000])
  1376827 y_list shape: torch.Size([40, 6000])
  1376828 batches: [tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39])]
  1376828 ----------------------------------------
  1376828 Sanity check I, comparing statistics from valid sequences and generated sequences:
  1376829 proportion of alts in generated w_list and x_list:  0.004945833333333333	0.007183333333333333
  1376830 proportion of alts in corresponding full sequences: 0.07647916666666667	0.07647916666666667
  1376830 
  1376830 Sanity check II, checking that relation between x, w, and y holds: unphased(w_i, x_i) == y_i
  1376838 number of matches between sampled y and w,x per each test sample:
  1376838 sample #0: 6000/6000 (100.0%)
  1376838 sample #1: 6000/6000 (100.0%)
  1376838 sample #2: 6000/6000 (100.0%)
  1376838 sample #3: 6000/6000 (100.0%)
  1376838 sample #4: 6000/6000 (100.0%)
  1376838 sample #5: 6000/6000 (100.0%)
  1376838 sample #6: 6000/6000 (100.0%)
  1376838 sample #7: 6000/6000 (100.0%)
  1376839 sample #8: 6000/6000 (100.0%)
  1376839 sample #9: 6000/6000 (100.0%)
  1376839 sample #10: 6000/6000 (100.0%)
  1376839 sample #11: 6000/6000 (100.0%)
  1376839 sample #12: 6000/6000 (100.0%)
  1376839 sample #13: 6000/6000 (100.0%)
  1376839 sample #14: 6000/6000 (100.0%)
  1376839 sample #15: 6000/6000 (100.0%)
  1376839 sample #16: 6000/6000 (100.0%)
  1376839 sample #17: 6000/6000 (100.0%)
  1376839 sample #18: 6000/6000 (100.0%)
  1376839 sample #19: 6000/6000 (100.0%)
  1376839 sample #20: 6000/6000 (100.0%)
  1376839 sample #21: 6000/6000 (100.0%)
  1376839 sample #22: 6000/6000 (100.0%)
  1376839 sample #23: 6000/6000 (100.0%)
  1376839 sample #24: 6000/6000 (100.0%)
  1376839 sample #25: 6000/6000 (100.0%)
  1376839 sample #26: 6000/6000 (100.0%)
  1376839 sample #27: 6000/6000 (100.0%)
  1376839 sample #28: 6000/6000 (100.0%)
  1376839 sample #29: 6000/6000 (100.0%)
  1376839 sample #30: 6000/6000 (100.0%)
  1376839 sample #31: 6000/6000 (100.0%)
  1376839 sample #32: 6000/6000 (100.0%)
  1376839 sample #33: 6000/6000 (100.0%)
  1376839 sample #34: 6000/6000 (100.0%)
  1376840 sample #35: 6000/6000 (100.0%)
  1376840 sample #36: 6000/6000 (100.0%)
  1376840 sample #37: 6000/6000 (100.0%)
  1376840 sample #38: 6000/6000 (100.0%)
  1376840 sample #39: 6000/6000 (100.0%)
  1376840 Measuring phasing accuracy by concordance
  1378566 number of sites to phase for all sequences: [21 35 30 20 17 34 17 25 14 24 19 31 12 24 16 29 20 21 27 26 28 18 33 26
 21 23 27 19 21 15 26 27 26 12 24 21 22 22 26 23]
  1378566 accuracy for all sequences: [0.52380955 0.54285717 0.46666667 0.7        0.7058824  0.44117647
 0.7647059  0.44       0.2857143  0.375      0.47368422 0.48387095
 0.08333334 0.5833333  0.1875     0.55172414 0.6        0.33333334
 0.5555556  0.5        0.5        0.5555556  0.42424244 0.3846154
 0.52380955 0.4347826  0.44444445 0.57894737 0.47619048 0.4
 0.53846157 0.5925926  0.61538464 0.33333334 0.5416667  0.47619048
 0.59090906 0.6818182  0.42307693 0.6086956 ]
  1378567 total accuracy: 0.5000000058505644
  1378567 ----------------------------------------
  1378567 Measuring imputation accuracy by concordance (only for sites with at least 1 alt allele)
  1378571 total non-ref sites: 27288 (11.37%)
  1381839 number of non-ref sites to impute for all sequences: [632 752 647 747 622 725 504 685 622 688 738 758 487 638 555 742 572 557
 684 610 712 654 762 627 773 596 700 634 535 587 629 740 692 464 602 699
 651 624 622 654]
  1381839 accuracy for all sequences: [0.00316456 0.00265957 0.0015456  0.00133869 0.00160772 0.00413793
 0.00396825 0.00437956 0.         0.00145349 0.         0.00395778
 0.00205339 0.00626959 0.         0.00943396 0.00174825 0.00359066
 0.00584795 0.00327869 0.00280899 0.00458716 0.00524934 0.00478469
 0.00129366 0.0033557  0.00428571 0.00315457 0.         0.00170358
 0.00476948 0.00135135 0.00433526 0.         0.00498339 0.00429185
 0.00460829 0.00961538 0.00482315 0.00611621]
  1381840 total accuracy: 0.0034719543301706397
  1381900 ====================Phasing test: infer_discrete (#5)====================
  1381900 sampling using infer_discrete method
  1413968 w_list shape: torch.Size([40, 6000])
  1413968 x_list shape: torch.Size([40, 6000])
  1413968 y_list shape: torch.Size([40, 6000])
  1413969 batches: [tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39])]
  1413969 ----------------------------------------
  1413969 Sanity check I, comparing statistics from valid sequences and generated sequences:
  1413970 proportion of alts in generated w_list and x_list:  0.0063416666666666665	0.005029166666666667
  1413971 proportion of alts in corresponding full sequences: 0.07647916666666667	0.07647916666666667
  1413971 
  1413971 Sanity check II, checking that relation between x, w, and y holds: unphased(w_i, x_i) == y_i
  1413979 number of matches between sampled y and w,x per each test sample:
  1413980 sample #0: 6000/6000 (100.0%)
  1413980 sample #1: 6000/6000 (100.0%)
  1413980 sample #2: 6000/6000 (100.0%)
  1413980 sample #3: 6000/6000 (100.0%)
  1413980 sample #4: 6000/6000 (100.0%)
  1413980 sample #5: 6000/6000 (100.0%)
  1413980 sample #6: 6000/6000 (100.0%)
  1413980 sample #7: 6000/6000 (100.0%)
  1413980 sample #8: 6000/6000 (100.0%)
  1413980 sample #9: 6000/6000 (100.0%)
  1413980 sample #10: 6000/6000 (100.0%)
  1413980 sample #11: 6000/6000 (100.0%)
  1413980 sample #12: 6000/6000 (100.0%)
  1413980 sample #13: 6000/6000 (100.0%)
  1413980 sample #14: 6000/6000 (100.0%)
  1413980 sample #15: 6000/6000 (100.0%)
  1413980 sample #16: 6000/6000 (100.0%)
  1413980 sample #17: 6000/6000 (100.0%)
  1413980 sample #18: 6000/6000 (100.0%)
  1413980 sample #19: 6000/6000 (100.0%)
  1413980 sample #20: 6000/6000 (100.0%)
  1413980 sample #21: 6000/6000 (100.0%)
  1413981 sample #22: 6000/6000 (100.0%)
  1413981 sample #23: 6000/6000 (100.0%)
  1413981 sample #24: 6000/6000 (100.0%)
  1413981 sample #25: 6000/6000 (100.0%)
  1413981 sample #26: 6000/6000 (100.0%)
  1413981 sample #27: 6000/6000 (100.0%)
  1413981 sample #28: 6000/6000 (100.0%)
  1413981 sample #29: 6000/6000 (100.0%)
  1413981 sample #30: 6000/6000 (100.0%)
  1413981 sample #31: 6000/6000 (100.0%)
  1413981 sample #32: 6000/6000 (100.0%)
  1413981 sample #33: 6000/6000 (100.0%)
  1413981 sample #34: 6000/6000 (100.0%)
  1413981 sample #35: 6000/6000 (100.0%)
  1413981 sample #36: 6000/6000 (100.0%)
  1413981 sample #37: 6000/6000 (100.0%)
  1413981 sample #38: 6000/6000 (100.0%)
  1413981 sample #39: 6000/6000 (100.0%)
  1413981 Measuring phasing accuracy by concordance
  1415692 number of sites to phase for all sequences: [21 35 30 20 17 34 17 25 14 24 19 31 12 24 16 29 20 21 27 26 28 18 33 26
 21 23 27 19 21 15 26 27 26 12 24 21 22 22 26 23]
  1415692 accuracy for all sequences: [0.47619048 0.45714286 0.53333336 0.3        0.29411766 0.5588235
 0.23529412 0.56       0.71428573 0.5833333  0.5263158  0.516129
 0.9166667  0.41666666 0.8125     0.41379312 0.4        0.6666667
 0.44444445 0.5        0.5        0.44444445 0.57575756 0.61538464
 0.47619048 0.5652174  0.5555556  0.42105263 0.52380955 0.6
 0.46153846 0.4074074  0.3846154  0.6666667  0.45833334 0.52380955
 0.4090909  0.3181818  0.5769231  0.39130434]
  1415693 total accuracy: 0.49783080743540914
  1415693 ----------------------------------------
  1415693 Measuring imputation accuracy by concordance (only for sites with at least 1 alt allele)
  1415697 total non-ref sites: 27288 (11.37%)
  1418977 number of non-ref sites to impute for all sequences: [632 752 647 747 622 725 504 685 622 688 738 758 487 638 555 742 572 557
 684 610 712 654 762 627 773 596 700 634 535 587 629 740 692 464 602 699
 651 624 622 654]
  1418978 accuracy for all sequences: [0.00316456 0.00930851 0.00309119 0.         0.00482315 0.01103448
 0.00396825 0.00145985 0.00160772 0.00145349 0.00135501 0.00131926
 0.         0.00470219 0.         0.00404313 0.         0.00718133
 0.00292398 0.00655738 0.00140449 0.00458716 0.00393701 0.00637959
 0.         0.00503356 0.00714286 0.00473186 0.         0.
 0.00317965 0.         0.00433526 0.00431034 0.00498339 0.
 0.00460829 0.00480769 0.         0.00611621]
  1418979 total accuracy: 0.0033562225176020886
  1419037 ====================Phasing test: infer_discrete (#6)====================
  1419037 sampling using infer_discrete method
  1451038 w_list shape: torch.Size([40, 6000])
  1451038 x_list shape: torch.Size([40, 6000])
  1451038 y_list shape: torch.Size([40, 6000])
  1451039 batches: [tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39])]
  1451039 ----------------------------------------
  1451039 Sanity check I, comparing statistics from valid sequences and generated sequences:
  1451040 proportion of alts in generated w_list and x_list:  0.985525	0.0
  1451041 proportion of alts in corresponding full sequences: 0.07647916666666667	0.07647916666666667
  1451041 
  1451041 Sanity check II, checking that relation between x, w, and y holds: unphased(w_i, x_i) == y_i
  1451051 number of matches between sampled y and w,x per each test sample:
  1451051 sample #0: 5986/6000 (99.76666666666667%)
  1451051 sample #1: 5995/6000 (99.91666666666667%)
  1451051 sample #2: 5991/6000 (99.85%)
  1451051 sample #3: 5986/6000 (99.76666666666667%)
  1451051 sample #4: 5984/6000 (99.73333333333333%)
  1451051 sample #5: 5992/6000 (99.86666666666666%)
  1451051 sample #6: 5990/6000 (99.83333333333333%)
  1451051 sample #7: 5990/6000 (99.83333333333333%)
  1451051 sample #8: 5983/6000 (99.71666666666667%)
  1451051 sample #9: 5990/6000 (99.83333333333333%)
  1451051 sample #10: 5982/6000 (99.7%)
  1451051 sample #11: 5986/6000 (99.76666666666667%)
  1451051 sample #12: 5992/6000 (99.86666666666666%)
  1451051 sample #13: 5988/6000 (99.8%)
  1451052 sample #14: 5989/6000 (99.81666666666666%)
  1451052 sample #15: 5990/6000 (99.83333333333333%)
  1451052 sample #16: 5992/6000 (99.86666666666666%)
  1451052 sample #17: 5983/6000 (99.71666666666667%)
  1451052 sample #18: 5991/6000 (99.85%)
  1451052 sample #19: 5988/6000 (99.8%)
  1451052 sample #20: 5992/6000 (99.86666666666666%)
  1451052 sample #21: 5985/6000 (99.75%)
  1451052 sample #22: 5994/6000 (99.9%)
  1451052 sample #23: 5991/6000 (99.85%)
  1451052 sample #24: 5988/6000 (99.8%)
  1451052 sample #25: 5985/6000 (99.75%)
  1451052 sample #26: 5991/6000 (99.85%)
  1451052 sample #27: 5986/6000 (99.76666666666667%)
  1451052 sample #28: 5989/6000 (99.81666666666666%)
  1451052 sample #29: 5984/6000 (99.73333333333333%)
  1451052 sample #30: 5991/6000 (99.85%)
  1451052 sample #31: 5990/6000 (99.83333333333333%)
  1451052 sample #32: 5994/6000 (99.9%)
  1451052 sample #33: 5987/6000 (99.78333333333333%)
  1451052 sample #34: 5989/6000 (99.81666666666666%)
  1451052 sample #35: 5986/6000 (99.76666666666667%)
  1451052 sample #36: 5991/6000 (99.85%)
  1451052 sample #37: 5990/6000 (99.83333333333333%)
  1451052 sample #38: 5994/6000 (99.9%)
  1451053 sample #39: 5991/6000 (99.85%)
  1451053 Measuring phasing accuracy by concordance
  1452774 number of sites to phase for all sequences: [21 35 30 20 17 34 17 25 14 24 19 31 12 24 16 29 20 21 27 26 28 18 33 26
 21 23 27 19 21 15 26 27 26 12 24 21 22 22 26 23]
  1452774 accuracy for all sequences: [0.47619048 0.6        0.36666667 0.55       0.7058824  0.5
 0.7058824  0.44       0.2857143  0.5        0.47368422 0.48387095
 0.         0.625      0.1875     0.55172414 0.55       0.33333334
 0.4074074  0.53846157 0.4642857  0.3888889  0.42424244 0.46153846
 0.3809524  0.26086956 0.4814815  0.42105263 0.47619048 0.33333334
 0.5        0.5185185  0.65384614 0.41666666 0.5416667  0.3809524
 0.45454547 0.72727275 0.3846154  0.6086956 ]
  1452775 total accuracy: 0.4750542342662809
  1452775 ----------------------------------------
  1452775 Measuring imputation accuracy by concordance (only for sites with at least 1 alt allele)
  1452779 total non-ref sites: 27288 (11.37%)
  1456094 number of non-ref sites to impute for all sequences: [632 752 647 747 622 725 504 685 622 688 738 758 487 638 555 742 572 557
 684 610 712 654 762 627 773 596 700 634 535 587 629 740 692 464 602 699
 651 624 622 654]
  1456095 accuracy for all sequences: [0.3227848  0.54787236 0.34621328 0.27576974 0.22186495 0.4289655
 0.35515872 0.32846716 0.2749196  0.3604651  0.3604336  0.3641161
 0.07802875 0.4169279  0.18738739 0.39892185 0.31993008 0.22082585
 0.21637426 0.4409836  0.3258427  0.21100917 0.35564303 0.27591705
 0.3557568  0.17114094 0.3942857  0.33753943 0.24672897 0.23168655
 0.28298888 0.4391892  0.40751445 0.25431034 0.39202657 0.26752505
 0.28725037 0.40384614 0.42122185 0.35474005]
  1456095 total accuracy: 0.32771391007178646
  1456157 ====================Phasing test: infer_discrete (#7)====================
  1456157 sampling using infer_discrete method
  1489310 w_list shape: torch.Size([40, 6000])
  1489310 x_list shape: torch.Size([40, 6000])
  1489310 y_list shape: torch.Size([40, 6000])
  1489311 batches: [tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39])]
  1489311 ----------------------------------------
  1489311 Sanity check I, comparing statistics from valid sequences and generated sequences:
  1489312 proportion of alts in generated w_list and x_list:  0.005691666666666667	0.00185
  1489314 proportion of alts in corresponding full sequences: 0.07647916666666667	0.07647916666666667
  1489314 
  1489314 Sanity check II, checking that relation between x, w, and y holds: unphased(w_i, x_i) == y_i
  1489322 number of matches between sampled y and w,x per each test sample:
  1489322 sample #0: 6000/6000 (100.0%)
  1489323 sample #1: 6000/6000 (100.0%)
  1489323 sample #2: 6000/6000 (100.0%)
  1489323 sample #3: 6000/6000 (100.0%)
  1489323 sample #4: 6000/6000 (100.0%)
  1489323 sample #5: 6000/6000 (100.0%)
  1489323 sample #6: 6000/6000 (100.0%)
  1489323 sample #7: 6000/6000 (100.0%)
  1489323 sample #8: 6000/6000 (100.0%)
  1489323 sample #9: 6000/6000 (100.0%)
  1489323 sample #10: 6000/6000 (100.0%)
  1489323 sample #11: 6000/6000 (100.0%)
  1489323 sample #12: 6000/6000 (100.0%)
  1489323 sample #13: 6000/6000 (100.0%)
  1489323 sample #14: 6000/6000 (100.0%)
  1489323 sample #15: 6000/6000 (100.0%)
  1489323 sample #16: 6000/6000 (100.0%)
  1489324 sample #17: 6000/6000 (100.0%)
  1489324 sample #18: 6000/6000 (100.0%)
  1489324 sample #19: 6000/6000 (100.0%)
  1489324 sample #20: 6000/6000 (100.0%)
  1489324 sample #21: 6000/6000 (100.0%)
  1489324 sample #22: 6000/6000 (100.0%)
  1489324 sample #23: 6000/6000 (100.0%)
  1489324 sample #24: 6000/6000 (100.0%)
  1489324 sample #25: 6000/6000 (100.0%)
  1489324 sample #26: 6000/6000 (100.0%)
  1489324 sample #27: 6000/6000 (100.0%)
  1489324 sample #28: 6000/6000 (100.0%)
  1489324 sample #29: 6000/6000 (100.0%)
  1489324 sample #30: 6000/6000 (100.0%)
  1489324 sample #31: 6000/6000 (100.0%)
  1489324 sample #32: 6000/6000 (100.0%)
  1489325 sample #33: 6000/6000 (100.0%)
  1489325 sample #34: 6000/6000 (100.0%)
  1489325 sample #35: 6000/6000 (100.0%)
  1489325 sample #36: 6000/6000 (100.0%)
  1489325 sample #37: 6000/6000 (100.0%)
  1489325 sample #38: 6000/6000 (100.0%)
  1489325 sample #39: 6000/6000 (100.0%)
  1489325 Measuring phasing accuracy by concordance
  1491038 number of sites to phase for all sequences: [21 35 30 20 17 34 17 25 14 24 19 31 12 24 16 29 20 21 27 26 28 18 33 26
 21 23 27 19 21 15 26 27 26 12 24 21 22 22 26 23]
  1491039 accuracy for all sequences: [0.47619048 0.6        0.36666667 0.55       0.7058824  0.5
 0.7058824  0.44       0.2857143  0.5        0.47368422 0.48387095
 0.         0.625      0.1875     0.55172414 0.55       0.33333334
 0.4074074  0.53846157 0.4642857  0.3888889  0.42424244 0.46153846
 0.3809524  0.26086956 0.4814815  0.42105263 0.47619048 0.33333334
 0.5        0.5185185  0.65384614 0.41666666 0.5416667  0.3809524
 0.45454547 0.72727275 0.3846154  0.6086956 ]
  1491040 total accuracy: 0.4750542342662809
  1491040 ----------------------------------------
  1491040 Measuring imputation accuracy by concordance (only for sites with at least 1 alt allele)
  1491044 total non-ref sites: 27288 (11.37%)
  1494309 number of non-ref sites to impute for all sequences: [632 752 647 747 622 725 504 685 622 688 738 758 487 638 555 742 572 557
 684 610 712 654 762 627 773 596 700 634 535 587 629 740 692 464 602 699
 651 624 622 654]
  1494310 accuracy for all sequences: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
  1494310 total accuracy: 0.0
  1494369 ====================Phasing test: infer_discrete (#8)====================
  1494369 sampling using infer_discrete method
  1527109 w_list shape: torch.Size([40, 6000])
  1527110 x_list shape: torch.Size([40, 6000])
  1527110 y_list shape: torch.Size([40, 6000])
  1527110 batches: [tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39])]
  1527110 ----------------------------------------
  1527110 Sanity check I, comparing statistics from valid sequences and generated sequences:
  1527111 proportion of alts in generated w_list and x_list:  0.00185	0.49549583333333336
  1527113 proportion of alts in corresponding full sequences: 0.07647916666666667	0.07647916666666667
  1527113 
  1527113 Sanity check II, checking that relation between x, w, and y holds: unphased(w_i, x_i) == y_i
  1527121 number of matches between sampled y and w,x per each test sample:
  1527121 sample #0: 6000/6000 (100.0%)
  1527122 sample #1: 6000/6000 (100.0%)
  1527122 sample #2: 6000/6000 (100.0%)
  1527122 sample #3: 6000/6000 (100.0%)
  1527122 sample #4: 6000/6000 (100.0%)
  1527122 sample #5: 6000/6000 (100.0%)
  1527122 sample #6: 6000/6000 (100.0%)
  1527122 sample #7: 6000/6000 (100.0%)
  1527122 sample #8: 6000/6000 (100.0%)
  1527122 sample #9: 6000/6000 (100.0%)
  1527122 sample #10: 6000/6000 (100.0%)
  1527122 sample #11: 6000/6000 (100.0%)
  1527122 sample #12: 6000/6000 (100.0%)
  1527122 sample #13: 6000/6000 (100.0%)
  1527122 sample #14: 6000/6000 (100.0%)
  1527122 sample #15: 6000/6000 (100.0%)
  1527122 sample #16: 6000/6000 (100.0%)
  1527122 sample #17: 6000/6000 (100.0%)
  1527122 sample #18: 6000/6000 (100.0%)
  1527122 sample #19: 6000/6000 (100.0%)
  1527122 sample #20: 6000/6000 (100.0%)
  1527122 sample #21: 6000/6000 (100.0%)
  1527122 sample #22: 6000/6000 (100.0%)
  1527122 sample #23: 6000/6000 (100.0%)
  1527122 sample #24: 6000/6000 (100.0%)
  1527123 sample #25: 6000/6000 (100.0%)
  1527123 sample #26: 6000/6000 (100.0%)
  1527123 sample #27: 6000/6000 (100.0%)
  1527123 sample #28: 6000/6000 (100.0%)
  1527123 sample #29: 6000/6000 (100.0%)
  1527123 sample #30: 6000/6000 (100.0%)
  1527123 sample #31: 6000/6000 (100.0%)
  1527123 sample #32: 6000/6000 (100.0%)
  1527123 sample #33: 6000/6000 (100.0%)
  1527123 sample #34: 6000/6000 (100.0%)
  1527123 sample #35: 6000/6000 (100.0%)
  1527123 sample #36: 6000/6000 (100.0%)
  1527123 sample #37: 6000/6000 (100.0%)
  1527123 sample #38: 6000/6000 (100.0%)
  1527123 sample #39: 6000/6000 (100.0%)
  1527123 Measuring phasing accuracy by concordance
  1528829 number of sites to phase for all sequences: [21 35 30 20 17 34 17 25 14 24 19 31 12 24 16 29 20 21 27 26 28 18 33 26
 21 23 27 19 21 15 26 27 26 12 24 21 22 22 26 23]
  1528830 accuracy for all sequences: [0.52380955 0.4        0.6333333  0.45       0.29411766 0.5
 0.29411766 0.56       0.71428573 0.5        0.5263158  0.516129
 1.         0.375      0.8125     0.44827586 0.45       0.6666667
 0.5925926  0.46153846 0.53571427 0.6111111  0.57575756 0.53846157
 0.61904764 0.73913044 0.5185185  0.57894737 0.52380955 0.6666667
 0.5        0.4814815  0.34615386 0.5833333  0.45833334 0.61904764
 0.54545456 0.27272728 0.61538464 0.39130434]
  1528831 total accuracy: 0.5249457745903742
  1528831 ----------------------------------------
  1528831 Measuring imputation accuracy by concordance (only for sites with at least 1 alt allele)
  1528835 total non-ref sites: 27288 (11.37%)
  1532113 number of non-ref sites to impute for all sequences: [632 752 647 747 622 725 504 685 622 688 738 758 487 638 555 742 572 557
 684 610 712 654 762 627 773 596 700 634 535 587 629 740 692 464 602 699
 651 624 622 654]
  1532113 accuracy for all sequences: [0.12816456 0.125      0.1885626  0.16198125 0.08681672 0.23724137
 0.13293651 0.2189781  0.1607717  0.18895349 0.14092141 0.1939314
 0.15811089 0.11755486 0.22162162 0.16037735 0.12762238 0.11310592
 0.20175439 0.15081967 0.1769663  0.21253823 0.24146982 0.18181819
 0.1992238  0.16442953 0.18714286 0.12460568 0.14579439 0.12436116
 0.18124007 0.18513514 0.18208092 0.15732759 0.07973422 0.15736766
 0.16897081 0.07371795 0.19935691 0.16055046]
  1532114 total accuracy: 0.16476352195751337
  1532175 ====================Phasing test: poutine_trace (#1)====================
  1532175 sampling using poutine_trace method
  1538915 w_list shape: torch.Size([40, 6000])
  1538915 x_list shape: torch.Size([40, 6000])
  1538915 y_list shape: torch.Size([40, 6000])
  1538916 batches: [tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39])]
  1539106 ----------------------------------------
  1539106 Sanity check I, comparing statistics from valid sequences and generated sequences:
  1539107 proportion of alts in generated w_list and x_list:  0.4124	0.0028291666666666665
  1539108 proportion of alts in corresponding full sequences: 0.07647916666666667	0.07647916666666667
  1539109 
  1539109 Sanity check II, checking that relation between x, w, and y holds: unphased(w_i, x_i) == y_i
  1539117 number of matches between sampled y and w,x per each test sample:
  1539117 sample #0: 5938/6000 (98.96666666666667%)
  1539117 sample #1: 5944/6000 (99.06666666666666%)
  1539117 sample #2: 5931/6000 (98.85%)
  1539117 sample #3: 5944/6000 (99.06666666666666%)
  1539117 sample #4: 5945/6000 (99.08333333333333%)
  1539117 sample #5: 5933/6000 (98.88333333333334%)
  1539117 sample #6: 5942/6000 (99.03333333333333%)
  1539117 sample #7: 5938/6000 (98.96666666666667%)
  1539117 sample #8: 5939/6000 (98.98333333333333%)
  1539117 sample #9: 5935/6000 (98.91666666666667%)
  1539117 sample #10: 5933/6000 (98.88333333333334%)
  1539117 sample #11: 5937/6000 (98.95%)
  1539117 sample #12: 5946/6000 (99.1%)
  1539117 sample #13: 5936/6000 (98.93333333333334%)
  1539117 sample #14: 5947/6000 (99.11666666666666%)
  1539117 sample #15: 5944/6000 (99.06666666666666%)
  1539117 sample #16: 5948/6000 (99.13333333333334%)
  1539117 sample #17: 5950/6000 (99.16666666666667%)
  1539117 sample #18: 5932/6000 (98.86666666666666%)
  1539117 sample #19: 5940/6000 (99.0%)
  1539117 sample #20: 5944/6000 (99.06666666666666%)
  1539118 sample #21: 5927/6000 (98.78333333333333%)
  1539118 sample #22: 5935/6000 (98.91666666666667%)
  1539118 sample #23: 5941/6000 (99.01666666666667%)
  1539118 sample #24: 5946/6000 (99.1%)
  1539118 sample #25: 5944/6000 (99.06666666666666%)
  1539118 sample #26: 5941/6000 (99.01666666666667%)
  1539118 sample #27: 5946/6000 (99.1%)
  1539118 sample #28: 5933/6000 (98.88333333333334%)
  1539118 sample #29: 5926/6000 (98.76666666666667%)
  1539118 sample #30: 5952/6000 (99.2%)
  1539118 sample #31: 5952/6000 (99.2%)
  1539118 sample #32: 5955/6000 (99.25%)
  1539118 sample #33: 5932/6000 (98.86666666666666%)
  1539118 sample #34: 5937/6000 (98.95%)
  1539118 sample #35: 5942/6000 (99.03333333333333%)
  1539118 sample #36: 5945/6000 (99.08333333333333%)
  1539118 sample #37: 5931/6000 (98.85%)
  1539118 sample #38: 5935/6000 (98.91666666666667%)
  1539118 sample #39: 5941/6000 (99.01666666666667%)
  1539118 Measuring phasing accuracy by concordance
  1540841 number of sites to phase for all sequences: [21 35 30 20 17 34 17 25 14 24 19 31 12 24 16 29 20 21 27 26 28 18 33 26
 21 23 27 19 21 15 26 27 26 12 24 21 22 22 26 23]
  1540842 accuracy for all sequences: [0.23809524 0.31428573 0.23333333 0.25       0.29411766 0.0882353
 0.11764706 0.16       0.14285715 0.25       0.31578946 0.12903225
 0.         0.33333334 0.125      0.1724138  0.3        0.14285715
 0.14814815 0.26923078 0.21428572 0.16666667 0.24242425 0.15384616
 0.23809524 0.08695652 0.11111111 0.21052632 0.0952381  0.13333334
 0.26923078 0.11111111 0.34615386 0.16666667 0.29166666 0.14285715
 0.13636364 0.4090909  0.07692308 0.08695652]
  1540842 total accuracy: 0.19631236762519513
  1540842 ----------------------------------------
  1540842 Measuring imputation accuracy by concordance (only for sites with at least 1 alt allele)
  1540846 total non-ref sites: 27288 (11.37%)
  1544227 number of non-ref sites to impute for all sequences: [632 752 647 747 622 725 504 685 622 688 738 758 487 638 555 742 572 557
 684 610 712 654 762 627 773 596 700 634 535 587 629 740 692 464 602 699
 651 624 622 654]
  1544228 accuracy for all sequences: [0.08702531 0.21276596 0.1901082  0.10307898 0.11254019 0.16275862
 0.08928572 0.13430656 0.12379421 0.16860466 0.17615177 0.15039578
 0.02669404 0.17554858 0.09189189 0.13881402 0.12062937 0.06642729
 0.1125731  0.19672132 0.12921348 0.09938838 0.16666667 0.08612441
 0.13454075 0.0704698  0.15714286 0.13880126 0.08598131 0.08688245
 0.14944357 0.13243243 0.13439307 0.15732759 0.14285715 0.10729614
 0.10752688 0.21153846 0.17845659 0.10550459]
  1544228 total accuracy: 0.13266723371663353
  1544293 ====================Phasing test: poutine_trace (#2)====================
  1544293 sampling using poutine_trace method
  1551240 w_list shape: torch.Size([40, 6000])
  1551240 x_list shape: torch.Size([40, 6000])
  1551240 y_list shape: torch.Size([40, 6000])
  1551241 batches: [tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39])]
  1551431 ----------------------------------------
  1551431 Sanity check I, comparing statistics from valid sequences and generated sequences:
  1551432 proportion of alts in generated w_list and x_list:  0.024379166666666667	0.0062125
  1551434 proportion of alts in corresponding full sequences: 0.07647916666666667	0.07647916666666667
  1551434 
  1551434 Sanity check II, checking that relation between x, w, and y holds: unphased(w_i, x_i) == y_i
  1551442 number of matches between sampled y and w,x per each test sample:
  1551442 sample #0: 5965/6000 (99.41666666666667%)
  1551442 sample #1: 5958/6000 (99.3%)
  1551442 sample #2: 5960/6000 (99.33333333333333%)
  1551442 sample #3: 5963/6000 (99.38333333333334%)
  1551442 sample #4: 5965/6000 (99.41666666666667%)
  1551442 sample #5: 5959/6000 (99.31666666666666%)
  1551442 sample #6: 5972/6000 (99.53333333333333%)
  1551442 sample #7: 5963/6000 (99.38333333333334%)
  1551442 sample #8: 5968/6000 (99.46666666666667%)
  1551442 sample #9: 5966/6000 (99.43333333333334%)
  1551442 sample #10: 5963/6000 (99.38333333333334%)
  1551442 sample #11: 5955/6000 (99.25%)
  1551442 sample #12: 5978/6000 (99.63333333333334%)
  1551442 sample #13: 5963/6000 (99.38333333333334%)
  1551443 sample #14: 5971/6000 (99.51666666666667%)
  1551443 sample #15: 5962/6000 (99.36666666666666%)
  1551443 sample #16: 5972/6000 (99.53333333333333%)
  1551443 sample #17: 5960/6000 (99.33333333333333%)
  1551443 sample #18: 5961/6000 (99.35%)
  1551443 sample #19: 5960/6000 (99.33333333333333%)
  1551443 sample #20: 5959/6000 (99.31666666666666%)
  1551443 sample #21: 5968/6000 (99.46666666666667%)
  1551443 sample #22: 5959/6000 (99.31666666666666%)
  1551443 sample #23: 5963/6000 (99.38333333333334%)
  1551443 sample #24: 5966/6000 (99.43333333333334%)
  1551443 sample #25: 5961/6000 (99.35%)
  1551443 sample #26: 5956/6000 (99.26666666666667%)
  1551443 sample #27: 5960/6000 (99.33333333333333%)
  1551443 sample #28: 5966/6000 (99.43333333333334%)
  1551443 sample #29: 5961/6000 (99.35%)
  1551443 sample #30: 5962/6000 (99.36666666666666%)
  1551443 sample #31: 5962/6000 (99.36666666666666%)
  1551443 sample #32: 5967/6000 (99.45%)
  1551443 sample #33: 5974/6000 (99.56666666666666%)
  1551443 sample #34: 5959/6000 (99.31666666666666%)
  1551443 sample #35: 5964/6000 (99.4%)
  1551443 sample #36: 5968/6000 (99.46666666666667%)
  1551443 sample #37: 5965/6000 (99.41666666666667%)
  1551443 sample #38: 5964/6000 (99.4%)
  1551443 sample #39: 5966/6000 (99.43333333333334%)
  1551444 Measuring phasing accuracy by concordance
  1553179 number of sites to phase for all sequences: [21 35 30 20 17 34 17 25 14 24 19 31 12 24 16 29 20 21 27 26 28 18 33 26
 21 23 27 19 21 15 26 27 26 12 24 21 22 22 26 23]
  1553179 accuracy for all sequences: [0.         0.         0.         0.05       0.         0.
 0.         0.04       0.         0.         0.05263158 0.
 0.         0.04166667 0.         0.03448276 0.         0.
 0.         0.         0.03571429 0.         0.         0.03846154
 0.         0.         0.         0.         0.04761905 0.
 0.11538462 0.         0.03846154 0.         0.04166667 0.
 0.04545455 0.09090909 0.         0.08695652]
  1553180 total accuracy: 0.019522776936308165
  1553180 ----------------------------------------
  1553180 Measuring imputation accuracy by concordance (only for sites with at least 1 alt allele)
  1553184 total non-ref sites: 27288 (11.37%)
  1556533 number of non-ref sites to impute for all sequences: [632 752 647 747 622 725 504 685 622 688 738 758 487 638 555 742 572 557
 684 610 712 654 762 627 773 596 700 634 535 587 629 740 692 464 602 699
 651 624 622 654]
  1556534 accuracy for all sequences: [0.00316456 0.0106383  0.0015456  0.00133869 0.00160772 0.04965517
 0.00396825 0.00875912 0.00160772 0.00290698 0.00135501 0.01187335
 0.00616016 0.01253918 0.         0.00269542 0.01048951 0.00179533
 0.00584795 0.01967213 0.01123596 0.00458716 0.00262467 0.00637959
 0.00129366 0.0033557  0.01285714 0.03312303 0.00747664 0.03236797
 0.02225755 0.00405405 0.0216763  0.01293103 0.01661129 0.02575107
 0.0015361  0.01442308 0.00482315 0.00764526]
  1556535 total accuracy: 0.010145822068673012
  1556600 ====================Phasing test: poutine_trace (#3)====================
  1556601 sampling using poutine_trace method
  1563518 w_list shape: torch.Size([40, 6000])
  1563519 x_list shape: torch.Size([40, 6000])
  1563519 y_list shape: torch.Size([40, 6000])
  1563519 batches: [tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39])]
  1563711 ----------------------------------------
  1563711 Sanity check I, comparing statistics from valid sequences and generated sequences:
  1563713 proportion of alts in generated w_list and x_list:  0.0018208333333333334	0.0
  1563714 proportion of alts in corresponding full sequences: 0.07647916666666667	0.07647916666666667
  1563714 
  1563714 Sanity check II, checking that relation between x, w, and y holds: unphased(w_i, x_i) == y_i
  1563722 number of matches between sampled y and w,x per each test sample:
  1563722 sample #0: 5965/6000 (99.41666666666667%)
  1563722 sample #1: 5960/6000 (99.33333333333333%)
  1563723 sample #2: 5961/6000 (99.35%)
  1563723 sample #3: 5966/6000 (99.43333333333334%)
  1563723 sample #4: 5967/6000 (99.45%)
  1563723 sample #5: 5958/6000 (99.3%)
  1563723 sample #6: 5973/6000 (99.55%)
  1563723 sample #7: 5966/6000 (99.43333333333334%)
  1563723 sample #8: 5969/6000 (99.48333333333333%)
  1563723 sample #9: 5966/6000 (99.43333333333334%)
  1563723 sample #10: 5963/6000 (99.38333333333334%)
  1563723 sample #11: 5955/6000 (99.25%)
  1563723 sample #12: 5980/6000 (99.66666666666667%)
  1563723 sample #13: 5964/6000 (99.4%)
  1563723 sample #14: 5973/6000 (99.55%)
  1563723 sample #15: 5960/6000 (99.33333333333333%)
  1563724 sample #16: 5972/6000 (99.53333333333333%)
  1563724 sample #17: 5962/6000 (99.36666666666666%)
  1563724 sample #18: 5963/6000 (99.38333333333334%)
  1563724 sample #19: 5962/6000 (99.36666666666666%)
  1563724 sample #20: 5964/6000 (99.4%)
  1563724 sample #21: 5966/6000 (99.43333333333334%)
  1563724 sample #22: 5961/6000 (99.35%)
  1563724 sample #23: 5965/6000 (99.41666666666667%)
  1563724 sample #24: 5967/6000 (99.45%)
  1563724 sample #25: 5962/6000 (99.36666666666666%)
  1563724 sample #26: 5964/6000 (99.4%)
  1563724 sample #27: 5966/6000 (99.43333333333334%)
  1563724 sample #28: 5968/6000 (99.46666666666667%)
  1563725 sample #29: 5968/6000 (99.46666666666667%)
  1563725 sample #30: 5965/6000 (99.41666666666667%)
  1563725 sample #31: 5961/6000 (99.35%)
  1563725 sample #32: 5968/6000 (99.46666666666667%)
  1563725 sample #33: 5975/6000 (99.58333333333333%)
  1563725 sample #34: 5964/6000 (99.4%)
  1563725 sample #35: 5965/6000 (99.41666666666667%)
  1563725 sample #36: 5969/6000 (99.48333333333333%)
  1563725 sample #37: 5968/6000 (99.46666666666667%)
  1563725 sample #38: 5968/6000 (99.46666666666667%)
  1563725 sample #39: 5968/6000 (99.46666666666667%)
  1563725 Measuring phasing accuracy by concordance
  1565454 number of sites to phase for all sequences: [21 35 30 20 17 34 17 25 14 24 19 31 12 24 16 29 20 21 27 26 28 18 33 26
 21 23 27 19 21 15 26 27 26 12 24 21 22 22 26 23]
  1565454 accuracy for all sequences: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
  1565455 total accuracy: 0.0
  1565455 ----------------------------------------
  1565455 Measuring imputation accuracy by concordance (only for sites with at least 1 alt allele)
  1565459 total non-ref sites: 27288 (11.37%)
  1568819 number of non-ref sites to impute for all sequences: [632 752 647 747 622 725 504 685 622 688 738 758 487 638 555 742 572 557
 684 610 712 654 762 627 773 596 700 634 535 587 629 740 692 464 602 699
 651 624 622 654]
  1568819 accuracy for all sequences: [0.         0.         0.         0.00133869 0.00321543 0.
 0.         0.         0.         0.         0.00135501 0.
 0.         0.         0.         0.         0.00174825 0.
 0.         0.00327869 0.         0.         0.         0.
 0.         0.         0.00142857 0.         0.00186916 0.
 0.         0.00540541 0.00144509 0.         0.         0.
 0.         0.         0.         0.00152905]
  1568820 total accuracy: 0.0005786590578128508
  1568884 ====================Phasing test: poutine_trace (#4)====================
  1568884 sampling using poutine_trace method
  1575788 w_list shape: torch.Size([40, 6000])
  1575788 x_list shape: torch.Size([40, 6000])
  1575788 y_list shape: torch.Size([40, 6000])
  1575789 batches: [tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39])]
  1575980 ----------------------------------------
  1575980 Sanity check I, comparing statistics from valid sequences and generated sequences:
  1575981 proportion of alts in generated w_list and x_list:  0.014158333333333334	0.16635416666666666
  1575982 proportion of alts in corresponding full sequences: 0.07647916666666667	0.07647916666666667
  1575983 
  1575983 Sanity check II, checking that relation between x, w, and y holds: unphased(w_i, x_i) == y_i
  1575992 number of matches between sampled y and w,x per each test sample:
  1575992 sample #0: 5950/6000 (99.16666666666667%)
  1575992 sample #1: 5950/6000 (99.16666666666667%)
  1575992 sample #2: 5950/6000 (99.16666666666667%)
  1575992 sample #3: 5958/6000 (99.3%)
  1575992 sample #4: 5953/6000 (99.21666666666667%)
  1575992 sample #5: 5958/6000 (99.3%)
  1575992 sample #6: 5956/6000 (99.26666666666667%)
  1575992 sample #7: 5954/6000 (99.23333333333333%)
  1575992 sample #8: 5958/6000 (99.3%)
  1575992 sample #9: 5954/6000 (99.23333333333333%)
  1575993 sample #10: 5954/6000 (99.23333333333333%)
  1575993 sample #11: 5946/6000 (99.1%)
  1575993 sample #12: 5962/6000 (99.36666666666666%)
  1575993 sample #13: 5954/6000 (99.23333333333333%)
  1575993 sample #14: 5962/6000 (99.36666666666666%)
  1575993 sample #15: 5948/6000 (99.13333333333334%)
  1575993 sample #16: 5959/6000 (99.31666666666666%)
  1575993 sample #17: 5947/6000 (99.11666666666666%)
  1575993 sample #18: 5949/6000 (99.15%)
  1575993 sample #19: 5952/6000 (99.2%)
  1575993 sample #20: 5951/6000 (99.18333333333334%)
  1575993 sample #21: 5958/6000 (99.3%)
  1575993 sample #22: 5951/6000 (99.18333333333334%)
  1575993 sample #23: 5957/6000 (99.28333333333333%)
  1575993 sample #24: 5959/6000 (99.31666666666666%)
  1575993 sample #25: 5952/6000 (99.2%)
  1575993 sample #26: 5955/6000 (99.25%)
  1575993 sample #27: 5948/6000 (99.13333333333334%)
  1575993 sample #28: 5957/6000 (99.28333333333333%)
  1575994 sample #29: 5956/6000 (99.26666666666667%)
  1575994 sample #30: 5955/6000 (99.25%)
  1575994 sample #31: 5949/6000 (99.15%)
  1575994 sample #32: 5957/6000 (99.28333333333333%)
  1575994 sample #33: 5958/6000 (99.3%)
  1575994 sample #34: 5952/6000 (99.2%)
  1575994 sample #35: 5951/6000 (99.18333333333334%)
  1575994 sample #36: 5959/6000 (99.31666666666666%)
  1575994 sample #37: 5954/6000 (99.23333333333333%)
  1575994 sample #38: 5957/6000 (99.28333333333333%)
  1575994 sample #39: 5951/6000 (99.18333333333334%)
  1575994 Measuring phasing accuracy by concordance
  1577728 number of sites to phase for all sequences: [21 35 30 20 17 34 17 25 14 24 19 31 12 24 16 29 20 21 27 26 28 18 33 26
 21 23 27 19 21 15 26 27 26 12 24 21 22 22 26 23]
  1577729 accuracy for all sequences: [0.04761905 0.08571429 0.16666667 0.         0.23529412 0.14705883
 0.         0.08       0.         0.16666667 0.15789473 0.09677419
 0.         0.04166667 0.0625     0.06896552 0.1        0.04761905
 0.07407407 0.07692308 0.14285715 0.16666667 0.12121212 0.07692308
 0.0952381  0.17391305 0.03703704 0.05263158 0.1904762  0.06666667
 0.11538462 0.03703704 0.07692308 0.08333334 0.125      0.
 0.22727273 0.04545455 0.         0.        ]
  1577729 total accuracy: 0.09002169362247119
  1577729 ----------------------------------------
  1577729 Measuring imputation accuracy by concordance (only for sites with at least 1 alt allele)
  1577734 total non-ref sites: 27288 (11.37%)
  1581084 number of non-ref sites to impute for all sequences: [632 752 647 747 622 725 504 685 622 688 738 758 487 638 555 742 572 557
 684 610 712 654 762 627 773 596 700 634 535 587 629 740 692 464 602 699
 651 624 622 654]
  1581085 accuracy for all sequences: [0.06329114 0.04654255 0.04636785 0.06157965 0.04180064 0.07310345
 0.05357143 0.08467153 0.0755627  0.06395349 0.04336043 0.06068601
 0.04928131 0.05015674 0.07747748 0.06199461 0.04895105 0.03231598
 0.07602339 0.04590164 0.06179775 0.05198777 0.07611549 0.07974482
 0.06597672 0.06375839 0.06857143 0.0615142  0.04112149 0.04599659
 0.07472178 0.08108108 0.06791908 0.04094828 0.03820598 0.05293276
 0.06451613 0.02403846 0.06752411 0.06269113]
  1581085 total accuracy: 0.05937041873445012
  1581149 ====================Phasing test: poutine_trace (#5)====================
  1581149 sampling using poutine_trace method
  1588285 w_list shape: torch.Size([40, 6000])
  1588285 x_list shape: torch.Size([40, 6000])
  1588285 y_list shape: torch.Size([40, 6000])
  1588285 batches: [tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39])]
  1588479 ----------------------------------------
  1588480 Sanity check I, comparing statistics from valid sequences and generated sequences:
  1588481 proportion of alts in generated w_list and x_list:  0.019216666666666667	0.2002
  1588482 proportion of alts in corresponding full sequences: 0.07647916666666667	0.07647916666666667
  1588482 
  1588482 Sanity check II, checking that relation between x, w, and y holds: unphased(w_i, x_i) == y_i
  1588490 number of matches between sampled y and w,x per each test sample:
  1588490 sample #0: 5950/6000 (99.16666666666667%)
  1588491 sample #1: 5949/6000 (99.15%)
  1588491 sample #2: 5944/6000 (99.06666666666666%)
  1588491 sample #3: 5944/6000 (99.06666666666666%)
  1588491 sample #4: 5954/6000 (99.23333333333333%)
  1588491 sample #5: 5952/6000 (99.2%)
  1588491 sample #6: 5961/6000 (99.35%)
  1588491 sample #7: 5949/6000 (99.15%)
  1588491 sample #8: 5954/6000 (99.23333333333333%)
  1588491 sample #9: 5955/6000 (99.25%)
  1588491 sample #10: 5951/6000 (99.18333333333334%)
  1588491 sample #11: 5950/6000 (99.16666666666667%)
  1588491 sample #12: 5967/6000 (99.45%)
  1588491 sample #13: 5953/6000 (99.21666666666667%)
  1588491 sample #14: 5959/6000 (99.31666666666666%)
  1588492 sample #15: 5950/6000 (99.16666666666667%)
  1588492 sample #16: 5960/6000 (99.33333333333333%)
  1588492 sample #17: 5949/6000 (99.15%)
  1588492 sample #18: 5951/6000 (99.18333333333334%)
  1588492 sample #19: 5953/6000 (99.21666666666667%)
  1588492 sample #20: 5957/6000 (99.28333333333333%)
  1588492 sample #21: 5951/6000 (99.18333333333334%)
  1588492 sample #22: 5950/6000 (99.16666666666667%)
  1588492 sample #23: 5952/6000 (99.2%)
  1588492 sample #24: 5954/6000 (99.23333333333333%)
  1588492 sample #25: 5956/6000 (99.26666666666667%)
  1588492 sample #26: 5950/6000 (99.16666666666667%)
  1588492 sample #27: 5956/6000 (99.26666666666667%)
  1588492 sample #28: 5955/6000 (99.25%)
  1588492 sample #29: 5954/6000 (99.23333333333333%)
  1588492 sample #30: 5953/6000 (99.21666666666667%)
  1588493 sample #31: 5955/6000 (99.25%)
  1588493 sample #32: 5958/6000 (99.3%)
  1588493 sample #33: 5955/6000 (99.25%)
  1588493 sample #34: 5956/6000 (99.26666666666667%)
  1588493 sample #35: 5958/6000 (99.3%)
  1588493 sample #36: 5958/6000 (99.3%)
  1588493 sample #37: 5955/6000 (99.25%)
  1588493 sample #38: 5954/6000 (99.23333333333333%)
  1588493 sample #39: 5952/6000 (99.2%)
  1588493 Measuring phasing accuracy by concordance
  1590215 number of sites to phase for all sequences: [21 35 30 20 17 34 17 25 14 24 19 31 12 24 16 29 20 21 27 26 28 18 33 26
 21 23 27 19 21 15 26 27 26 12 24 21 22 22 26 23]
  1590215 accuracy for all sequences: [0.23809524 0.02857143 0.06666667 0.05       0.         0.
 0.11764706 0.16       0.07142857 0.125      0.21052632 0.22580644
 0.41666666 0.04166667 0.1875     0.10344828 0.15       0.04761905
 0.11111111 0.15384616 0.10714286 0.22222222 0.12121212 0.03846154
 0.1904762  0.08695652 0.18518518 0.15789473 0.0952381  0.26666668
 0.03846154 0.11111111 0.15384616 0.08333334 0.04166667 0.14285715
 0.13636364 0.13636364 0.07692308 0.13043478]
  1590216 total accuracy: 0.11822125938904839
  1590216 ----------------------------------------
  1590216 Measuring imputation accuracy by concordance (only for sites with at least 1 alt allele)
  1590220 total non-ref sites: 27288 (11.37%)
  1593571 number of non-ref sites to impute for all sequences: [632 752 647 747 622 725 504 685 622 688 738 758 487 638 555 742 572 557
 684 610 712 654 762 627 773 596 700 634 535 587 629 740 692 464 602 699
 651 624 622 654]
  1593572 accuracy for all sequences: [0.05537975 0.0518617  0.07727975 0.08567604 0.05466238 0.11586207
 0.06944445 0.07737226 0.07234727 0.09738372 0.06910569 0.08443272
 0.06570842 0.05015674 0.1027027  0.05660377 0.0541958  0.03949731
 0.08479532 0.0557377  0.08286517 0.08562691 0.10498688 0.08293461
 0.08538163 0.06543624 0.08       0.05362776 0.05607476 0.04940375
 0.07154213 0.06486487 0.06213873 0.04525862 0.01993356 0.06008584
 0.07373272 0.05128205 0.09163987 0.06727829]
  1593572 total accuracy: 0.07028778656528471
  1593638 ====================Phasing test: poutine_trace (#6)====================
  1593638 sampling using poutine_trace method
  1600646 w_list shape: torch.Size([40, 6000])
  1600646 x_list shape: torch.Size([40, 6000])
  1600646 y_list shape: torch.Size([40, 6000])
  1600646 batches: [tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39])]
  1600835 ----------------------------------------
  1600836 Sanity check I, comparing statistics from valid sequences and generated sequences:
  1600837 proportion of alts in generated w_list and x_list:  0.512275	0.065875
  1600838 proportion of alts in corresponding full sequences: 0.07647916666666667	0.07647916666666667
  1600838 
  1600838 Sanity check II, checking that relation between x, w, and y holds: unphased(w_i, x_i) == y_i
  1600846 number of matches between sampled y and w,x per each test sample:
  1600846 sample #0: 5932/6000 (98.86666666666666%)
  1600846 sample #1: 5939/6000 (98.98333333333333%)
  1600846 sample #2: 5926/6000 (98.76666666666667%)
  1600846 sample #3: 5934/6000 (98.9%)
  1600846 sample #4: 5926/6000 (98.76666666666667%)
  1600847 sample #5: 5931/6000 (98.85%)
  1600847 sample #6: 5934/6000 (98.9%)
  1600847 sample #7: 5935/6000 (98.91666666666667%)
  1600847 sample #8: 5922/6000 (98.7%)
  1600847 sample #9: 5930/6000 (98.83333333333333%)
  1600847 sample #10: 5927/6000 (98.78333333333333%)
  1600847 sample #11: 5925/6000 (98.75%)
  1600847 sample #12: 5938/6000 (98.96666666666667%)
  1600847 sample #13: 5936/6000 (98.93333333333334%)
  1600847 sample #14: 5920/6000 (98.66666666666667%)
  1600847 sample #15: 5931/6000 (98.85%)
  1600847 sample #16: 5926/6000 (98.76666666666667%)
  1600847 sample #17: 5919/6000 (98.65%)
  1600847 sample #18: 5927/6000 (98.78333333333333%)
  1600847 sample #19: 5931/6000 (98.85%)
  1600847 sample #20: 5936/6000 (98.93333333333334%)
  1600848 sample #21: 5924/6000 (98.73333333333333%)
  1600848 sample #22: 5936/6000 (98.93333333333334%)
  1600848 sample #23: 5935/6000 (98.91666666666667%)
  1600848 sample #24: 5935/6000 (98.91666666666667%)
  1600848 sample #25: 5930/6000 (98.83333333333333%)
  1600848 sample #26: 5929/6000 (98.81666666666666%)
  1600848 sample #27: 5931/6000 (98.85%)
  1600848 sample #28: 5937/6000 (98.95%)
  1600848 sample #29: 5924/6000 (98.73333333333333%)
  1600848 sample #30: 5932/6000 (98.86666666666666%)
  1600848 sample #31: 5932/6000 (98.86666666666666%)
  1600848 sample #32: 5942/6000 (99.03333333333333%)
  1600848 sample #33: 5927/6000 (98.78333333333333%)
  1600848 sample #34: 5929/6000 (98.81666666666666%)
  1600848 sample #35: 5929/6000 (98.81666666666666%)
  1600849 sample #36: 5936/6000 (98.93333333333334%)
  1600849 sample #37: 5931/6000 (98.85%)
  1600849 sample #38: 5931/6000 (98.85%)
  1600849 sample #39: 5935/6000 (98.91666666666667%)
  1600849 Measuring phasing accuracy by concordance
  1602716 number of sites to phase for all sequences: [21 35 30 20 17 34 17 25 14 24 19 31 12 24 16 29 20 21 27 26 28 18 33 26
 21 23 27 19 21 15 26 27 26 12 24 21 22 22 26 23]
  1602716 accuracy for all sequences: [0.23809524 0.22857143 0.3        0.3        0.29411766 0.29411766
 0.47058824 0.24       0.         0.25       0.21052632 0.16129032
 0.08333334 0.29166666 0.         0.2413793  0.2        0.23809524
 0.14814815 0.11538462 0.17857143 0.2777778  0.3030303  0.46153846
 0.23809524 0.13043478 0.18518518 0.15789473 0.3809524  0.06666667
 0.26923078 0.33333334 0.3846154  0.25       0.45833334 0.14285715
 0.4090909  0.36363637 0.11538462 0.26086956]
  1602717 total accuracy: 0.24837310495028783
  1602717 ----------------------------------------
  1602717 Measuring imputation accuracy by concordance (only for sites with at least 1 alt allele)
  1602721 total non-ref sites: 27288 (11.37%)
  1606115 number of non-ref sites to impute for all sequences: [632 752 647 747 622 725 504 685 622 688 738 758 487 638 555 742 572 557
 684 610 712 654 762 627 773 596 700 634 535 587 629 740 692 464 602 699
 651 624 622 654]
  1606115 accuracy for all sequences: [0.16455697 0.28856382 0.18083462 0.15528782 0.14308682 0.22482759
 0.21230158 0.17956205 0.14951769 0.19331396 0.1910569  0.18337731
 0.06365503 0.22413793 0.11891892 0.19407009 0.18181819 0.12746859
 0.13304093 0.23606557 0.18258427 0.12844037 0.17979002 0.16746412
 0.1927555  0.09563758 0.20714286 0.16719243 0.12336449 0.13117547
 0.14626391 0.23783784 0.1950867  0.14655173 0.22923589 0.15593705
 0.1812596  0.20032051 0.21382637 0.20183486]
  1606116 total accuracy: 0.1781498345781896
  1606180 ====================Phasing test: poutine_trace (#7)====================
  1606180 sampling using poutine_trace method
  1613226 w_list shape: torch.Size([40, 6000])
  1613226 x_list shape: torch.Size([40, 6000])
  1613226 y_list shape: torch.Size([40, 6000])
  1613226 batches: [tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39])]
  1613415 ----------------------------------------
  1613416 Sanity check I, comparing statistics from valid sequences and generated sequences:
  1613417 proportion of alts in generated w_list and x_list:  0.031704166666666665	0.3181541666666667
  1613418 proportion of alts in corresponding full sequences: 0.07647916666666667	0.07647916666666667
  1613418 
  1613418 Sanity check II, checking that relation between x, w, and y holds: unphased(w_i, x_i) == y_i
  1613427 number of matches between sampled y and w,x per each test sample:
  1613427 sample #0: 5945/6000 (99.08333333333333%)
  1613427 sample #1: 5936/6000 (98.93333333333334%)
  1613427 sample #2: 5940/6000 (99.0%)
  1613427 sample #3: 5950/6000 (99.16666666666667%)
  1613427 sample #4: 5945/6000 (99.08333333333333%)
  1613427 sample #5: 5934/6000 (98.9%)
  1613427 sample #6: 5938/6000 (98.96666666666667%)
  1613427 sample #7: 5942/6000 (99.03333333333333%)
  1613427 sample #8: 5935/6000 (98.91666666666667%)
  1613427 sample #9: 5949/6000 (99.15%)
  1613427 sample #10: 5936/6000 (98.93333333333334%)
  1613428 sample #11: 5931/6000 (98.85%)
  1613428 sample #12: 5954/6000 (99.23333333333333%)
  1613428 sample #13: 5947/6000 (99.11666666666666%)
  1613428 sample #14: 5944/6000 (99.06666666666666%)
  1613428 sample #15: 5940/6000 (99.0%)
  1613428 sample #16: 5958/6000 (99.3%)
  1613428 sample #17: 5938/6000 (98.96666666666667%)
  1613428 sample #18: 5950/6000 (99.16666666666667%)
  1613428 sample #19: 5942/6000 (99.03333333333333%)
  1613428 sample #20: 5947/6000 (99.11666666666666%)
  1613428 sample #21: 5938/6000 (98.96666666666667%)
  1613428 sample #22: 5942/6000 (99.03333333333333%)
  1613428 sample #23: 5946/6000 (99.1%)
  1613428 sample #24: 5940/6000 (99.0%)
  1613428 sample #25: 5946/6000 (99.1%)
  1613428 sample #26: 5948/6000 (99.13333333333334%)
  1613428 sample #27: 5939/6000 (98.98333333333333%)
  1613428 sample #28: 5944/6000 (99.06666666666666%)
  1613428 sample #29: 5945/6000 (99.08333333333333%)
  1613429 sample #30: 5944/6000 (99.06666666666666%)
  1613429 sample #31: 5937/6000 (98.95%)
  1613429 sample #32: 5955/6000 (99.25%)
  1613429 sample #33: 5948/6000 (99.13333333333334%)
  1613429 sample #34: 5943/6000 (99.05%)
  1613429 sample #35: 5950/6000 (99.16666666666667%)
  1613429 sample #36: 5941/6000 (99.01666666666667%)
  1613429 sample #37: 5943/6000 (99.05%)
  1613429 sample #38: 5945/6000 (99.08333333333333%)
  1613429 sample #39: 5948/6000 (99.13333333333334%)
  1613429 Measuring phasing accuracy by concordance
  1615158 number of sites to phase for all sequences: [21 35 30 20 17 34 17 25 14 24 19 31 12 24 16 29 20 21 27 26 28 18 33 26
 21 23 27 19 21 15 26 27 26 12 24 21 22 22 26 23]
  1615159 accuracy for all sequences: [0.14285715 0.08571429 0.03333334 0.15       0.         0.11764706
 0.         0.24       0.21428572 0.16666667 0.15789473 0.09677419
 0.33333334 0.08333334 0.25       0.1724138  0.25       0.14285715
 0.14814815 0.1923077  0.10714286 0.2777778  0.12121212 0.11538462
 0.1904762  0.3043478  0.18518518 0.15789473 0.1904762  0.13333334
 0.11538462 0.07407407 0.1923077  0.41666666 0.25       0.2857143
 0.13636364 0.09090909 0.11538462 0.17391305]
  1615159 total accuracy: 0.15618221400358154
  1615159 ----------------------------------------
  1615159 Measuring imputation accuracy by concordance (only for sites with at least 1 alt allele)
  1615164 total non-ref sites: 27288 (11.37%)
  1618551 number of non-ref sites to impute for all sequences: [632 752 647 747 622 725 504 685 622 688 738 758 487 638 555 742 572 557
 684 610 712 654 762 627 773 596 700 634 535 587 629 740 692 464 602 699
 651 624 622 654]
  1618552 accuracy for all sequences: [0.10759494 0.125      0.10664606 0.13386881 0.06752411 0.14068966
 0.09126984 0.1620438  0.10128617 0.10465116 0.07588076 0.13588391
 0.11293635 0.07053292 0.12972973 0.09164421 0.08741259 0.09156194
 0.12573099 0.09836066 0.14466292 0.12996942 0.1167979  0.1275917
 0.11772316 0.08892617 0.10714286 0.07413249 0.11401869 0.09540034
 0.10810811 0.11351351 0.10115607 0.08189655 0.03986711 0.11301859
 0.12596007 0.05608974 0.13665594 0.09480122]
  1618553 total accuracy: 0.10724481177419921
  1618617 ====================Phasing test: poutine_trace (#8)====================
  1618617 sampling using poutine_trace method
  1625621 w_list shape: torch.Size([40, 6000])
  1625621 x_list shape: torch.Size([40, 6000])
  1625621 y_list shape: torch.Size([40, 6000])
  1625622 batches: [tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39])]
  1625811 ----------------------------------------
  1625811 Sanity check I, comparing statistics from valid sequences and generated sequences:
  1625812 proportion of alts in generated w_list and x_list:  0.03975833333333333	0.4418916666666667
  1625814 proportion of alts in corresponding full sequences: 0.07647916666666667	0.07647916666666667
  1625814 
  1625814 Sanity check II, checking that relation between x, w, and y holds: unphased(w_i, x_i) == y_i
  1625822 number of matches between sampled y and w,x per each test sample:
  1625822 sample #0: 5932/6000 (98.86666666666666%)
  1625823 sample #1: 5943/6000 (99.05%)
  1625823 sample #2: 5929/6000 (98.81666666666666%)
  1625823 sample #3: 5939/6000 (98.98333333333333%)
  1625823 sample #4: 5928/6000 (98.8%)
  1625823 sample #5: 5935/6000 (98.91666666666667%)
  1625823 sample #6: 5936/6000 (98.93333333333334%)
  1625823 sample #7: 5933/6000 (98.88333333333334%)
  1625823 sample #8: 5925/6000 (98.75%)
  1625823 sample #9: 5946/6000 (99.1%)
  1625823 sample #10: 5928/6000 (98.8%)
  1625823 sample #11: 5933/6000 (98.88333333333334%)
  1625823 sample #12: 5934/6000 (98.9%)
  1625823 sample #13: 5943/6000 (99.05%)
  1625823 sample #14: 5933/6000 (98.88333333333334%)
  1625823 sample #15: 5934/6000 (98.9%)
  1625824 sample #16: 5934/6000 (98.9%)
  1625824 sample #17: 5932/6000 (98.86666666666666%)
  1625824 sample #18: 5938/6000 (98.96666666666667%)
  1625824 sample #19: 5934/6000 (98.9%)
  1625824 sample #20: 5940/6000 (99.0%)
  1625824 sample #21: 5938/6000 (98.96666666666667%)
  1625824 sample #22: 5937/6000 (98.95%)
  1625824 sample #23: 5942/6000 (99.03333333333333%)
  1625824 sample #24: 5936/6000 (98.93333333333334%)
  1625824 sample #25: 5936/6000 (98.93333333333334%)
  1625824 sample #26: 5944/6000 (99.06666666666666%)
  1625824 sample #27: 5923/6000 (98.71666666666667%)
  1625824 sample #28: 5930/6000 (98.83333333333333%)
  1625825 sample #29: 5932/6000 (98.86666666666666%)
  1625825 sample #30: 5938/6000 (98.96666666666667%)
  1625825 sample #31: 5933/6000 (98.88333333333334%)
  1625825 sample #32: 5932/6000 (98.86666666666666%)
  1625825 sample #33: 5941/6000 (99.01666666666667%)
  1625825 sample #34: 5933/6000 (98.88333333333334%)
  1625825 sample #35: 5940/6000 (99.0%)
  1625825 sample #36: 5953/6000 (99.21666666666667%)
  1625825 sample #37: 5938/6000 (98.96666666666667%)
  1625825 sample #38: 5943/6000 (99.05%)
  1625825 sample #39: 5933/6000 (98.88333333333334%)
  1625825 Measuring phasing accuracy by concordance
  1627559 number of sites to phase for all sequences: [21 35 30 20 17 34 17 25 14 24 19 31 12 24 16 29 20 21 27 26 28 18 33 26
 21 23 27 19 21 15 26 27 26 12 24 21 22 22 26 23]
  1627559 accuracy for all sequences: [0.1904762  0.11428571 0.26666668 0.25       0.11764706 0.2647059
 0.11764706 0.16       0.14285715 0.33333334 0.21052632 0.19354838
 0.33333334 0.25       0.4375     0.20689656 0.15       0.33333334
 0.22222222 0.23076923 0.2857143  0.2777778  0.24242425 0.3846154
 0.2857143  0.17391305 0.25925925 0.10526316 0.23809524 0.
 0.1923077  0.18518518 0.07692308 0.33333334 0.16666667 0.2857143
 0.3181818  0.13636364 0.23076923 0.26086956]
  1627560 total accuracy: 0.22342733567713913
  1627560 ----------------------------------------
  1627560 Measuring imputation accuracy by concordance (only for sites with at least 1 alt allele)
  1627564 total non-ref sites: 27288 (11.37%)
  1630926 number of non-ref sites to impute for all sequences: [632 752 647 747 622 725 504 685 622 688 738 758 487 638 555 742 572 557
 684 610 712 654 762 627 773 596 700 634 535 587 629 740 692 464 602 699
 651 624 622 654]
  1630927 accuracy for all sequences: [0.13449366 0.13696809 0.16692427 0.16867469 0.11736334 0.21103448
 0.13095239 0.1810219  0.16237941 0.20348836 0.1300813  0.16490765
 0.11704312 0.10971787 0.21621622 0.14824797 0.12412588 0.12567325
 0.17690058 0.15245901 0.1488764  0.17278287 0.19553806 0.18819776
 0.16429496 0.16442953 0.16428572 0.11987381 0.13831776 0.13287905
 0.17170112 0.17972973 0.18208092 0.10560345 0.08305648 0.1416309
 0.15360983 0.07692308 0.19453377 0.12538226]
  1630927 total accuracy: 0.15361468932201128
<function model_31 at 0x7ffadd466550>
